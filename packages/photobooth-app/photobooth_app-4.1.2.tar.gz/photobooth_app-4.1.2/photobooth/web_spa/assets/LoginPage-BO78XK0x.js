import{t as q,r as F,Z as $,$ as E,a0 as I,a1 as A,y as R,O as j,P as D,a2 as L,a3 as Q,a4 as O,a5 as N,a6 as T,j as K,c as M,a7 as U,a8 as Y,_ as Z,f as z,n as G,p as m,q as u,I as k,a9 as g,B as b,D as _,C as H,Y as J}from"./index-GcjhGhv5.js";import{Q as W}from"./QInput-CtPM7FZs.js";import{Q as X}from"./QPage-Cgmo9RBu.js";import"./use-key-composition-Bi5PR9iB.js";import"./use-id-DMhSHLAp.js";const ee=q({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(o,{slots:l,emit:f}){const r=D(),d=F(null);let s=0;const a=[];function h(e){const c=typeof e=="boolean"?e:o.noErrorFocus!==!0,v=++s,C=(t,n)=>{f(`validation${t===!0?"Success":"Error"}`,n)},P=t=>{const n=t.validate();return typeof n.then=="function"?n.then(i=>({valid:i,comp:t}),i=>({valid:!1,comp:t,err:i})):Promise.resolve({valid:n,comp:t})};return(o.greedy===!0?Promise.all(a.map(P)).then(t=>t.filter(n=>n.valid!==!0)):a.reduce((t,n)=>t.then(()=>P(n).then(i=>{if(i.valid===!1)return Promise.reject(i)})),Promise.resolve()).catch(t=>[t])).then(t=>{if(t===void 0||t.length===0)return v===s&&C(!0),!0;if(v===s){const{comp:n,err:i}=t[0];if(i!==void 0&&console.error(i),C(!1,n),c===!0){const V=t.find(({comp:B})=>typeof B.focus=="function"&&L(B.$)===!1);V!==void 0&&V.comp.focus()}}return!1})}function y(){s++,a.forEach(e=>{typeof e.resetValidation=="function"&&e.resetValidation()})}function x(e){e!==void 0&&Q(e);const c=s+1;h().then(v=>{c===s&&v===!0&&(o.onSubmit!==void 0?f("submit",e):e!==void 0&&e.target!==void 0&&typeof e.target.submit=="function"&&e.target.submit())})}function S(e){e!==void 0&&Q(e),f("reset"),O(()=>{y(),o.autofocus===!0&&o.noResetFocus!==!0&&p()})}function p(){N(()=>{if(d.value===null)return;const e=d.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||d.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||d.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(d.value.querySelectorAll("[tabindex]"),c=>c.tabIndex!==-1);e?.focus({preventScroll:!0})})}$(T,{bindComponent(e){a.push(e)},unbindComponent(e){const c=a.indexOf(e);c!==-1&&a.splice(c,1)}});let w=!1;return E(()=>{w=!0}),I(()=>{w===!0&&o.autofocus===!0&&p()}),A(()=>{o.autofocus===!0&&p()}),Object.assign(r.proxy,{validate:h,resetValidation:y,submit:x,reset:S,focus:p,getValidationComponents:()=>a}),()=>R("form",{class:"q-form",ref:d,onSubmit:x,onReset:S},j(l.default))}}),te=K({__name:"LoginPage",setup(o,{expose:l}){l();const f=M(),r=U({username:"admin",password:null}),s={router:f,user:r,submit:async()=>{try{await Y(r),f.push("/admin")}catch(a){console.error(a)}}};return Object.defineProperty(s,"__isScriptSetup",{enumerable:!1,value:!0}),s}}),oe={class:"text-h5 text-weight-bold"},ae={class:""},ne={class:""},se={href:"http://photobooth-app.org/setup/admincenter/",target:"_blank",class:"text-weight-bold",style:{"text-decoration":"none"}};function re(o,l,f,r,d,s){return z(),G(X,{id:"login-page",class:"flex flex-center"},{default:m(()=>[u(J,{class:"q-pa-md no-shadow login-card",bordered:""},{default:m(()=>[u(k,{flat:"",color:"grey",icon:"sym_o_arrow_back_ios_new",onClick:l[0]||(l[0]=a=>r.router.go(-1))}),u(ee,{ref:"form",class:"q-gutter-md",onSubmit:r.submit},{default:m(()=>[u(g,{class:"text-center"},{default:m(()=>[b("div",oe,_(o.$t("Sign in")),1),b("div",ae,_(o.$t("Sign in below to access the admin dashboard.")),1)]),_:1}),u(g,null,{default:m(()=>[u(W,{modelValue:r.user.password,"onUpdate:modelValue":l[1]||(l[1]=a=>r.user.password=a),filled:"",type:"password",label:"Password"},null,8,["modelValue"])]),_:1}),u(g,null,{default:m(()=>[u(k,{rounded:"",color:"primary",label:"Sign in",class:"full-width",type:"submit"})]),_:1}),u(g,{class:"text-center"},{default:m(()=>[b("div",ne,[H(_(o.$t("Looking for the default password or issues signing in?"))+" ",1),b("a",se,_(o.$t("Check the documentation.")),1)])]),_:1})]),_:1},512)]),_:1})]),_:1})}const me=Z(te,[["render",re],["__file","LoginPage.vue"]]);export{me as default};
