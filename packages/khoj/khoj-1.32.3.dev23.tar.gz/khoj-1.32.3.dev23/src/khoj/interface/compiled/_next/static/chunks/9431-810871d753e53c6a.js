(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9431],{33494:function(e,t,l){"use strict";l.d(t,{Z:function(){return O}});var n=l(57437),i=l(18676),s=l.n(i),a=l(62869),o=l(26110),r=l(95186),c=l(61984),d=l(64697),u=l(57757),m=l(54271),x=l(19181),f=l(60331),g=l(48741),h=l(27648),p=l(2265),v=l(63861),j=l(48667);function w(e){let{onLoad:t}=e;return(0,n.jsx)(j.default,{id:"google-signin",src:"https://accounts.google.com/gsi/client",async:!0,defer:!0,onLoad:t})}var y=l(17814),N=l(9467),b=l(32660),_=l(76858),k=l(94508);let C=p.createContext(null);function S(){let e=p.useContext(C);if(!e)throw Error("useCarousel must be used within a <Carousel />");return e}let M=p.forwardRef((e,t)=>{let{orientation:l="horizontal",opts:i,setApi:s,plugins:a,className:o,children:r,...c}=e,[d,u]=(0,N.Z)({...i,axis:"horizontal"===l?"x":"y"},a),[m,x]=p.useState(!1),[f,g]=p.useState(!1),h=p.useCallback(e=>{e&&(x(e.canScrollPrev()),g(e.canScrollNext()))},[]),v=p.useCallback(()=>{null==u||u.scrollPrev()},[u]),j=p.useCallback(()=>{null==u||u.scrollNext()},[u]),w=p.useCallback(e=>{"ArrowLeft"===e.key?(e.preventDefault(),v()):"ArrowRight"===e.key&&(e.preventDefault(),j())},[v,j]);return p.useEffect(()=>{u&&s&&s(u)},[u,s]),p.useEffect(()=>{if(u)return h(u),u.on("reInit",h),u.on("select",h),()=>{null==u||u.off("select",h)}},[u,h]),(0,n.jsx)(C.Provider,{value:{carouselRef:d,api:u,opts:i,orientation:l||((null==i?void 0:i.axis)==="y"?"vertical":"horizontal"),scrollPrev:v,scrollNext:j,canScrollPrev:m,canScrollNext:f},children:(0,n.jsx)("div",{ref:t,onKeyDownCapture:w,className:(0,k.cn)("relative",o),role:"region","aria-roledescription":"carousel",...c,children:r})})});M.displayName="Carousel";let E=p.forwardRef((e,t)=>{let{className:l,...i}=e,{carouselRef:s,orientation:a}=S();return(0,n.jsx)("div",{ref:s,className:"overflow-hidden",children:(0,n.jsx)("div",{ref:t,className:(0,k.cn)("flex","horizontal"===a?"-ml-4":"-mt-4 flex-col",l),...i})})});E.displayName="CarouselContent";let z=p.forwardRef((e,t)=>{let{className:l,...i}=e,{orientation:s}=S();return(0,n.jsx)("div",{ref:t,role:"group","aria-roledescription":"slide",className:(0,k.cn)("min-w-0 shrink-0 grow-0 basis-full","horizontal"===s?"pl-4":"pt-4",l),...i})});z.displayName="CarouselItem";let P=p.forwardRef((e,t)=>{let{className:l,variant:i="outline",size:s="icon",...o}=e,{orientation:r,scrollPrev:c,canScrollPrev:d}=S();return(0,n.jsxs)(a.z,{ref:t,variant:i,size:s,className:(0,k.cn)("absolute  h-8 w-8 rounded-full","horizontal"===r?"-left-12 top-1/2 -translate-y-1/2":"-top-12 left-1/2 -translate-x-1/2 rotate-90",l),disabled:!d,onClick:c,...o,children:[(0,n.jsx)(b.Z,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Previous slide"})]})});P.displayName="CarouselPrevious";let B=p.forwardRef((e,t)=>{let{className:l,variant:i="outline",size:s="icon",...o}=e,{orientation:r,scrollNext:c,canScrollNext:d}=S();return(0,n.jsxs)(a.z,{ref:t,variant:i,size:s,className:(0,k.cn)("absolute h-8 w-8 rounded-full","horizontal"===r?"-right-12 top-1/2 -translate-y-1/2":"-bottom-12 left-1/2 -translate-x-1/2 rotate-90",l),disabled:!d,onClick:c,...o,children:[(0,n.jsx)(_.Z,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Next slide"})]})});B.displayName="CarouselNext";var I=l(66070),T=l(26371);let R=e=>fetch(e).then(e=>e.json());function O(e){var t;let{data:l,error:i,isLoading:s}=(0,v.ZP)("/auth/oauth/metadata",R),[a,r]=(0,p.useState)(!1),[c,d]=(0,p.useState)(""),[u,m]=(0,p.useState)(!1),[x,f]=(0,p.useState)(!1);(0,p.useEffect)(()=>{var e,t;let n=window.google;n&&(n.accounts.id.initialize({client_id:null==l?void 0:null===(e=l.google)||void 0===e?void 0:e.client_id,callback:g,auto_select:!1,login_uri:null==l?void 0:null===(t=l.google)||void 0===t?void 0:t.redirect_uri}),n.accounts.id.renderButton(document.getElementById("g_id_signin"),{theme:"outline",size:"large",width:"100%"}))},[l]);let g=()=>{var e,t;if(!(null==l?void 0:null===(e=l.google)||void 0===e?void 0:e.client_id)||!(null==l?void 0:null===(t=l.google)||void 0===t?void 0:t.redirect_uri))return;let n="".concat(window.location.origin).concat(l.google.redirect_uri),i=new URLSearchParams({client_id:l.google.client_id,redirect_uri:n,response_type:"code",scope:"email profile openid",state:window.location.pathname,access_type:"offline",prompt:"consent select_account",include_granted_scopes:"true"});window.location.href="https://accounts.google.com/o/oauth2/v2/auth?".concat(i)},h=()=>{var e,t,n,i;let s=window.google;(null==l?void 0:null===(e=l.google)||void 0===e?void 0:e.client_id)&&(null==l?void 0:null===(t=l.google)||void 0===t?void 0:t.redirect_uri)&&(s.accounts.id.initialize({client_id:null==l?void 0:null===(n=l.google)||void 0===n?void 0:n.client_id,callback:g,auto_select:!1,login_uri:null==l?void 0:null===(i=l.google)||void 0===i?void 0:i.redirect_uri}),s.accounts.id.renderButton(document.getElementById("g_id_signin"),{theme:"outline",size:"large",width:"100%"}))};function j(){fetch("/auth/magic",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:c})}).then(e=>{if(e.ok)return m(!0),u&&f(!0),e.json();throw Error("Failed to send magic link")}).then(e=>{console.log(e)}).catch(e=>{console.error(e)})}return e.isMobileWidth?(0,n.jsx)(y.dy,{open:!0,onOpenChange:e.onOpenChange,children:(0,n.jsx)(y.sc,{className:"flex flex-col gap-4 w-full mb-4",children:(0,n.jsx)("div",{children:a?(0,n.jsx)(Z,{email:c,setEmail:d,checkEmail:u,setCheckEmail:m,setUseEmailSignIn:r,recheckEmail:x,setRecheckEmail:f,handleMagicLinkSignIn:j}):(0,n.jsx)(L,{handleGoogleScriptLoad:h,handleGoogleSignIn:g,isLoading:s,data:l,setUseEmailSignIn:r,isMobileWidth:e.isMobileWidth})})})}):(0,n.jsx)(o.Vq,{open:!0,onOpenChange:e.onOpenChange,children:(0,n.jsx)(o.cZ,{className:"flex flex-col gap-4 ".concat(a?"w-fit":"p-0 pb-4 m-0 max-w-xl"),children:(0,n.jsx)("div",{children:a?(0,n.jsx)(Z,{email:c,setEmail:d,checkEmail:u,setCheckEmail:m,setUseEmailSignIn:r,recheckEmail:x,setRecheckEmail:f,handleMagicLinkSignIn:j}):(0,n.jsx)(L,{handleGoogleScriptLoad:h,handleGoogleSignIn:g,isLoading:s,data:l,setUseEmailSignIn:r,isMobileWidth:null!==(t=e.isMobileWidth)&&void 0!==t&&t})})})})}function Z(e){let{email:t,setEmail:l,checkEmail:i,setCheckEmail:s,setUseEmailSignIn:o,recheckEmail:c,handleMagicLinkSignIn:g}=e,[h,v]=(0,p.useState)(""),[j,w]=(0,p.useState)(""),[y,N]=(0,p.useState)(0);return(0,n.jsxs)("div",{className:"flex flex-col gap-4 p-4",children:[(0,n.jsx)(a.z,{variant:"ghost",className:"w-fit p-1 m-0 flex gap-2 items-center justify-center text-sm absolute top-5 left-5 h-fit rounded-full border border-gray-200",onClick:()=>{o(!1)},children:(0,n.jsx)(d.X,{className:"h-6 w-6"})}),(0,n.jsx)("div",{children:(0,n.jsx)("div",{className:"text-center font-bold text-xl",children:"Get started with Khoj"})}),(0,n.jsx)("div",{className:"text-center text-sm text-muted-foreground",children:i?c?"A new link has been sent to ".concat(t,"."):"A one time sign in code has been sent to ".concat(t,"."):"You will receive a sign-in code on the email address you provide below"}),!i&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.I,{placeholder:"Email",className:"p-6 w-[300px] mx-auto rounded-lg",disabled:i,value:t,onKeyDown:e=>{"Enter"===e.key&&g()},onChange:e=>l(e.target.value)}),(0,n.jsxs)(a.z,{variant:"default",className:"p-6 w-[300px] mx-auto flex gap-2 items-center justify-center rounded-lg",onClick:g,disabled:i,children:[(0,n.jsx)(u.g,{className:"h-6 w-6 mr-2 font-bold"}),i?"Check your email":"Send sign in code"]})]}),i&&(0,n.jsxs)("div",{className:"flex items-center justify-center gap-4 text-muted-foreground flex-col",children:[(0,n.jsx)(T.Zn,{autoFocus:!0,maxLength:6,value:h||"",onChange:v,disabled:y>=5,onComplete:()=>setTimeout(()=>{!function(){let e="/auth/magic?code=".concat(h,"&email=").concat(t);if(y>=5){w("Too many failed attempts. Please try again tomorrow.");return}fetch(e,{method:"GET",headers:{"Content-Type":"application/json"}}).then(e=>{if(e.ok)e.redirected&&(window.location.href=e.url);else if(401===e.status)w("Invalid OTP."),N(y+1),y+1>=5&&w("Too many failed attempts. Please try again tomorrow.");else if(429===e.status)w("Too many failed attempts. Please try again tomorrow."),N(5);else if(403===e.status)w("OTP expired. Please request a new one.");else throw Error("Failed to verify OTP")}).catch(e=>{console.error(e)})}()},1e3),children:(0,n.jsxs)(T.hf,{children:[(0,n.jsx)(T.cY,{index:0}),(0,n.jsx)(T.cY,{index:1}),(0,n.jsx)(T.cY,{index:2}),(0,n.jsx)(T.cY,{index:3}),(0,n.jsx)(T.cY,{index:4}),(0,n.jsx)(T.cY,{index:5})]})}),j&&(0,n.jsxs)("div",{className:"text-red-500 text-sm",children:[j," ",5-y," remaining attempts."]})]}),i&&(0,n.jsxs)("div",{className:"flex items-center justify-center gap-4 text-muted-foreground flex-col md:flex-row",children:[(0,n.jsxs)(a.z,{variant:"ghost",className:"p-0 text-orange-500",disabled:c,onClick:()=>{g()},children:[(0,n.jsx)(m.t,{className:"h-6 w-6 mr-2 text-gray-500"}),"Resend email"]}),(0,n.jsx)(x.a,{className:"h-6 w-6 hidden md:block opacity-50"}),(0,n.jsxs)(a.z,{variant:"ghost",className:"p-0 text-orange-500",disabled:c,onClick:()=>{l(""),s(!1)},children:[(0,n.jsx)(f.k,{className:"h-6 w-6 mr-2 text-gray-500"}),"Use a different email"]})]})]})}function L(e){let{handleGoogleScriptLoad:t,handleGoogleSignIn:l,isLoading:i,data:o,setUseEmailSignIn:r,isMobileWidth:d}=e,m=(0,p.useRef)((0,c.Z)({delay:4e3,stopOnInteraction:!0})),[x,f]=(0,p.useState)(!1);return(0,n.jsxs)("div",{className:"flex flex-col gap-4 p-4 md:p-0",children:[!d&&(0,n.jsxs)(M,{plugins:[m.current],className:"w-full",onMouseEnter:()=>{m.current.stop(),f(!0)},onMouseLeave:()=>{m.current.play(),f(!1)},children:[(0,n.jsx)(E,{children:[{src:"https://assets.khoj.dev/sign_in_demos/research_mode.gif",alt:"Research tip",description:"Simplify Deep Work"},{src:"https://assets.khoj.dev/sign_in_demos/custom_agents.gif",alt:"Personalize tip",description:"Personalize your AI"},{src:"https://assets.khoj.dev/sign_in_demos/docment_questions.gif",alt:"Document tip",description:"Ask Anything"}].map((e,t)=>(0,n.jsx)(z,{children:(0,n.jsx)("div",{className:"relative p-0",children:(0,n.jsx)(I.Zb,{children:(0,n.jsxs)(I.aY,{className:"flex flex-col items-center justify-center rounded-b-none rounded-t-lg p-0",children:[(0,n.jsx)("img",{src:e.src,alt:e.alt,className:"w-full h-auto rounded-b-none rounded-t-lg"}),(0,n.jsx)("div",{className:"absolute bottom-0 flex items-center justify-center text-white bg-gradient-to-t from-black to-transparent text-center w-full p-4 py-6",children:e.description})]})})})},t))}),x&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(P,{className:"absolute left-0"}),(0,n.jsx)(B,{className:"absolute right-0"})]})]}),(0,n.jsx)("div",{className:"flex flex-col gap-4 text-center p-2",children:(0,n.jsx)("div",{className:"text-center font-bold text-xl",children:"Sign in to unlock your second brain"})}),(0,n.jsxs)("div",{className:"flex flex-col gap-8 pb-4 text-center align-middle items-center",children:[(0,n.jsx)(w,{onLoad:t}),(0,n.jsxs)(a.z,{variant:"outline",className:"w-[300px] p-8 flex gap-2 items-center justify-center rounded-lg font-bold",onClick:l,disabled:i||!(null==o?void 0:o.google)||!(null==o?void 0:o.google.client_id)||!(null==o?void 0:o.google.redirect_uri),children:[i?(0,n.jsx)(g.$,{className:"h-6 w-6"}):(0,n.jsxs)("button",{className:"".concat(s().gsiMaterialButton),children:[(0,n.jsx)("div",{className:s().gsiMaterialButtonState}),(0,n.jsx)("div",{className:s().gsiMaterialButtonContentWrapper,children:(0,n.jsx)("div",{className:"".concat(s().gsiMaterialButtonIcon," flex items-center justify-center"),children:(0,n.jsxs)("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",xmlnsXlink:"http://www.w3.org/1999/xlink",children:[(0,n.jsx)("path",{fill:"#EA4335",d:"M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z"}),(0,n.jsx)("path",{fill:"#4285F4",d:"M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"}),(0,n.jsx)("path",{fill:"#FBBC05",d:"M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z"}),(0,n.jsx)("path",{fill:"#34A853",d:"M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z"}),(0,n.jsx)("path",{fill:"none",d:"M0 0h48v48H0z"})]})})})]}),"Continue with Google"]}),(0,n.jsxs)(a.z,{variant:"outline",className:"w-[300px] p-8 flex gap-2 items-center justify-center rounded-lg font-bold",onClick:()=>{r(!0)},children:[(0,n.jsx)(u.g,{className:"h-6 w-6"}),"Continue with Email"]})]}),(0,n.jsxs)("div",{className:"text-center text-muted-foreground text-sm mb-[20px]",children:["By logging in, you agree to our"," ",(0,n.jsx)(h.default,{href:"https://khoj.dev/terms-of-service",children:"Terms of Service"}),". See"," ",(0,n.jsx)(h.default,{href:"https://khoj.dev/privacy-policy",children:"Privacy Policy"}),"."]})]})}},26371:function(e,t,l){"use strict";l.d(t,{Zn:function(){return r},cY:function(){return d},hf:function(){return c}});var n=l(57437),i=l(2265),s=l(35934),a=l(62319),o=l(94508);let r=i.forwardRef((e,t)=>{let{className:l,containerClassName:i,...a}=e;return(0,n.jsx)(s.uZ,{ref:t,containerClassName:(0,o.cn)("flex items-center gap-2 has-[:disabled]:opacity-50",i),className:(0,o.cn)("disabled:cursor-not-allowed",l),...a})});r.displayName="InputOTP";let c=i.forwardRef((e,t)=>{let{className:l,...i}=e;return(0,n.jsx)("div",{ref:t,className:(0,o.cn)("flex items-center",l),...i})});c.displayName="InputOTPGroup";let d=i.forwardRef((e,t)=>{let{index:l,className:a,...r}=e,{char:c,hasFakeCaret:d,isActive:u}=i.useContext(s.VM).slots[l];return(0,n.jsxs)("div",{ref:t,className:(0,o.cn)("relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md",u&&"z-10 ring-2 ring-ring ring-offset-background",a),...r,children:[c,d&&(0,n.jsx)("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center",children:(0,n.jsx)("div",{className:"h-4 w-px animate-caret-blink bg-foreground duration-1000"})})]})});d.displayName="InputOTPSlot",i.forwardRef((e,t)=>{let{...l}=e;return(0,n.jsx)("div",{ref:t,role:"separator",...l,children:(0,n.jsx)(a.Z,{})})}).displayName="InputOTPSeparator"},76818:function(e,t,l){"use strict";l.d(t,{g:function(){return a}});var n=l(57437),i=l(2265),s=l(94508);let a=i.forwardRef((e,t)=>{let{className:l,...i}=e;return(0,n.jsx)("textarea",{className:(0,s.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",l),ref:t,...i})});a.displayName="Textarea"},18676:function(e){e.exports={gsiMaterialButton:"loginPrompt_gsiMaterialButton__8QVFH",gsiMaterialButtonIcon:"loginPrompt_gsiMaterialButtonIcon__6TSC5",gsiMaterialButtonContentWrapper:"loginPrompt_gsiMaterialButtonContentWrapper__9tahB",gsiMaterialButtonContents:"loginPrompt_gsiMaterialButtonContents__3_YcB",gsiMaterialButtonState:"loginPrompt_gsiMaterialButtonState__CDGQm","gsiMaterialButton-State":"loginPrompt_gsiMaterialButton-State__mAfCZ"}}}]);