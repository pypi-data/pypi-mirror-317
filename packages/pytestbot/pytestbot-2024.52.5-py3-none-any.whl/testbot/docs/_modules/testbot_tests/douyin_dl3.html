<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>testbot_tests.douyin_dl3 &mdash; testbot 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=eafc0fe6" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js?v=359c27e9"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=4825356b"></script>
        <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            testbot
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">使用文档</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../usage_quickstart.html">快速入门</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">开发文档</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../dev_pipeline_setup.html">搭建GitLab流水线</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev_training.html">培训宣讲推广</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev_coding_spec.html">编码规范</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API文档</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../fwk_apis.html">框架核心API接口</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../base_apis.html">基础原子API接口</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../buz_apis.html">业务封装API接口</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">脚本文档</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../dfm_scripts.html">DFM测试脚本</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">testbot</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
          <li class="breadcrumb-item"><a href="../testbot_tests.html">testbot_tests</a></li>
      <li class="breadcrumb-item active">testbot_tests.douyin_dl3</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for testbot_tests.douyin_dl3</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>

<div class="viewcode-block" id="__copyright__"><a class="viewcode-back" href="../../autoapi/testbot_tests/douyin_dl3/index.html#testbot_tests.douyin_dl3.__copyright__">[docs]</a><span class="n">__copyright__</span> <span class="o">=</span> <span class="s2">&quot;Copyright (c) 2024 Nuanguang Gu(Sunny) Reserved&quot;</span></div>
<div class="viewcode-block" id="__author__"><a class="viewcode-back" href="../../autoapi/testbot_tests/douyin_dl3/index.html#testbot_tests.douyin_dl3.__author__">[docs]</a><span class="n">__author__</span> <span class="o">=</span> <span class="s2">&quot;Nuanguang Gu(Sunny)&quot;</span></div>
<div class="viewcode-block" id="__email__"><a class="viewcode-back" href="../../autoapi/testbot_tests/douyin_dl3/index.html#testbot_tests.douyin_dl3.__email__">[docs]</a><span class="n">__email__</span> <span class="o">=</span> <span class="s2">&quot;nuanguang.gu@aliyun.com&quot;</span></div>

<span class="kn">import</span> <span class="nn">requests</span>

<span class="k">if</span> <span class="vm">__name__</span><span class="o">==</span><span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
<div class="viewcode-block" id="headers"><a class="viewcode-back" href="../../autoapi/testbot_tests/douyin_dl3/index.html#testbot_tests.douyin_dl3.headers">[docs]</a>    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Cookie&#39;</span><span class="p">:</span> <span class="s1">&#39;live_use_vvc=</span><span class="si">%22f</span><span class="s1">alse%22; ttwid=1%7CG6lGqi6Ff4CkL7CvVzZUs1d4p1Wlhjt7HJ-6y-m_a10%7C1718359839%7C578cb6fbb8035bd5d8eb032a284e62731ea8c52fabea3d5d25ec23812f196784; xgplayer_user_id=540713429609; bd_ticket_guard_client_web_domain=2; SEARCH_RESULT_LIST_TYPE=</span><span class="si">%22s</span><span class="s1">ingle%22; UIFID_TEMP=51ca78498d256c95a0dced57d4510398a1a949b0b9c77a6623ae0f8de9c0e7bd6687731578462a35e6440cfea2793336ac550de0caae2b478cd3b342aeaddd0d1045737297af70d960bb15840dfad3a9; fpk1=U2FsdGVkX19cn86sMpnxCTyZelruhAHKmxPtHYJH0A9QtcNaEzzNbsK4pQjQ6CdchDqkxJGzFc+KrhSFX5xaXQ==; fpk2=ce58a5260ba4fa9cdedf4886e4cf45c6; UIFID=51ca78498d256c95a0dced57d4510398a1a949b0b9c77a6623ae0f8de9c0e7bd8518c6df8dc1ba20d6e6bb6ae0d8bccfbbd7ed734b1cfdb15ec9080a1a43f5cb352d2ec4cf7d8a37193952af907a9ea8aff2de45b8559b8abb9e76fd347120c94489e9a3b1a9674c74c9c70f42a2e02412dff3b0b09243af287c88767d3c748210dc22dd04d607bd7a72736930e40abbb3610f30e550389ae0855eecbcbe31b8; __live_version__=%221.1.2.2252%22; s_v_web_id=verify_lztf7ywm_4zA5RL96_bnv5_4Uke_BXUL_Vtk8j1ogZmPa; dy_swidth=1536; dy_sheight=960; passport_csrf_token=36f176a3408c79b116c165ea08bb671e; passport_csrf_token_default=36f176a3408c79b116c165ea08bb671e; download_guide=</span><span class="si">%223%</span><span class="s1">2F20240814</span><span class="si">%2F</span><span class="s1">0%22; pwa2=</span><span class="si">%220%</span><span class="s1">7C0%7C3%7C0%22; xgplayer_device_id=80801261586; __ac_signature=_02B4Z6wo00f01Y0BWtwAAIDBe2hT-FFUQDmNIV5AAAX-1GGEAB9ZaB21OJ9t.dxPXQdLSMi9oCmEoLE8UKshniY2BUzB8uasIRSDglbF2rGAIsfHWpzbT8WIrkQGBNrwqOMK9dfOyub5Us6905; douyin.com; device_web_cpu_core=16; device_web_memory_size=8; architecture=amd64; strategyABtestKey=</span><span class="si">%221723803732.47%</span><span class="s1">22; csrf_session_id=3b1b688068bbd5595ac78ff25b14047f; FORCE_LOGIN=%7B%22videoConsumedRemainSeconds</span><span class="si">%22%</span><span class="s1">3A180%2C</span><span class="si">%22i</span><span class="s1">sForcePopClose</span><span class="si">%22%</span><span class="s1">3A1%7D; n_mh=zZaPBSnkyqtBai3M6tY6vrYoypDErulzJKBWh0Qrs7Q; toutiao_sso_user=b70d55bb894b00add3212b7592a07d53; toutiao_sso_user_ss=b70d55bb894b00add3212b7592a07d53; passport_auth_status=e089787001c932d45db88204c6e6addf%2C; passport_auth_status_ss=e089787001c932d45db88204c6e6addf%2C; is_staff_user=false; __ac_nonce=066bf380000aa4eda554c; _bd_ticket_crypt_doamin=2; _bd_ticket_crypt_cookie=595e2a15361ded4fd2d2625d4739712a; __security_server_data_status=1; publish_badge_show_info=</span><span class="si">%220%</span><span class="s1">2C0%2C0%2C1723807766475%22; store-region=cn-sd; store-region-src=uid; FOLLOW_LIVE_POINT_INFO=%22MS4wLjABAAAAqZoS-o-UF_qYha33xhRR8WdUbd8y7AUI4-cUMA-k4XE</span><span class="si">%2F</span><span class="s1">1723824000000</span><span class="si">%2F</span><span class="s1">1723807787495</span><span class="si">%2F</span><span class="s1">1723807757815</span><span class="si">%2F</span><span class="s1">0%22; xg_device_score=7.6193612098364385; volume_info=%7B</span><span class="si">%22i</span><span class="s1">sUserMute</span><span class="si">%22%</span><span class="s1">3Afalse%2C</span><span class="si">%22i</span><span class="s1">sMute</span><span class="si">%22%</span><span class="s1">3Atrue%2C%22volume</span><span class="si">%22%</span><span class="s1">3A0.554%7D; sso_uid_tt=36fd926168b8b682239a5bccdb657c67; sso_uid_tt_ss=36fd926168b8b682239a5bccdb657c67; sid_ucp_sso_v1=1.0.0-KDJjOWM0ZWQxNWZjMzBkZGM4OGM1MWNmNDMzNDM3NjEzNWU0ZWU1MGIKCRDg9fy1BhjvMRoCbGYiIGI3MGQ1NWJiODk0YjAwYWRkMzIxMmI3NTkyYTA3ZDUz; ssid_ucp_sso_v1=1.0.0-KDJjOWM0ZWQxNWZjMzBkZGM4OGM1MWNmNDMzNDM3NjEzNWU0ZWU1MGIKCRDg9fy1BhjvMRoCbGYiIGI3MGQ1NWJiODk0YjAwYWRkMzIxMmI3NTkyYTA3ZDUz; sid_guard=a71eb1a258f4d5836d2d974aaac9c94f%7C1723808481%7C21600%7CFri%2C+16-Aug-2024+17%3A41%3A21+GMT; uid_tt=59b0f0eb529323e75c4c8c06d9c7d455; uid_tt_ss=59b0f0eb529323e75c4c8c06d9c7d455; sid_tt=a71eb1a258f4d5836d2d974aaac9c94f; sessionid=a71eb1a258f4d5836d2d974aaac9c94f; sessionid_ss=a71eb1a258f4d5836d2d974aaac9c94f; sid_ucp_v1=1.0.0-KDAyMTI4ZDUxZDJjOTA1OWIzMWIyNmY3NjcxNjU2OTI2NGYzYTBhZWUKCBDh9fy1BhgNGgJscSIgYTcxZWIxYTI1OGY0ZDU4MzZkMmQ5NzRhYWFjOWM5NGY; ssid_ucp_v1=1.0.0-KDAyMTI4ZDUxZDJjOTA1OWIzMWIyNmY3NjcxNjU2OTI2NGYzYTBhZWUKCBDh9fy1BhgNGgJscSIgYTcxZWIxYTI1OGY0ZDU4MzZkMmQ5NzRhYWFjOWM5NGY; odin_tt=421d97515f5c5cb073b1d91fbca72c15935fc3b22a3b8f1e7cba0da9d205490de1e5a03ac9c2681622fcb21d8314efb70d8b78a8736671637867ee6e3ce89fcd2316d6e726920636cea43b13505e4e57; passport_fe_beating_status=false; WallpaperGuide=%7B</span><span class="si">%22s</span><span class="s1">howTime</span><span class="si">%22%</span><span class="s1">3A1723615106441%2C</span><span class="si">%22c</span><span class="s1">loseTime</span><span class="si">%22%</span><span class="s1">3A0%2C</span><span class="si">%22s</span><span class="s1">howCount</span><span class="si">%22%</span><span class="s1">3A1%2C</span><span class="si">%22c</span><span class="s1">ursor1</span><span class="si">%22%</span><span class="s1">3A63%2C</span><span class="si">%22c</span><span class="s1">ursor2</span><span class="si">%22%</span><span class="s1">3A0%7D; stream_recommend_feed_params=</span><span class="si">%22%</span><span class="s1">7B%5C</span><span class="si">%22c</span><span class="s1">ookie_enabled%5C</span><span class="si">%22%</span><span class="s1">3Atrue%2C%5C</span><span class="si">%22s</span><span class="s1">creen_width%5C</span><span class="si">%22%</span><span class="s1">3A1536%2C%5C</span><span class="si">%22s</span><span class="s1">creen_height%5C</span><span class="si">%22%</span><span class="s1">3A960%2C%5C%22browser_online%5C</span><span class="si">%22%</span><span class="s1">3Atrue%2C%5C</span><span class="si">%22c</span><span class="s1">pu_core_num%5C</span><span class="si">%22%</span><span class="s1">3A16%2C%5C</span><span class="si">%22d</span><span class="s1">evice_memory%5C</span><span class="si">%22%</span><span class="s1">3A8%2C%5C</span><span class="si">%22d</span><span class="s1">ownlink%5C</span><span class="si">%22%</span><span class="s1">3A10%2C%5C</span><span class="si">%22e</span><span class="s1">ffective_type%5C</span><span class="si">%22%</span><span class="s1">3A%5C</span><span class="si">%224g</span><span class="s1">%5C</span><span class="si">%22%</span><span class="s1">2C%5C</span><span class="si">%22r</span><span class="s1">ound_trip_time%5C</span><span class="si">%22%</span><span class="s1">3A100%7D%22; stream_player_status_params=</span><span class="si">%22%</span><span class="s1">7B%5C</span><span class="si">%22i</span><span class="s1">s_auto_play%5C</span><span class="si">%22%</span><span class="s1">3A0%2C%5C</span><span class="si">%22i</span><span class="s1">s_full_screen%5C</span><span class="si">%22%</span><span class="s1">3A0%2C%5C</span><span class="si">%22i</span><span class="s1">s_full_webscreen%5C</span><span class="si">%22%</span><span class="s1">3A0%2C%5C</span><span class="si">%22i</span><span class="s1">s_mute%5C</span><span class="si">%22%</span><span class="s1">3A1%2C%5C</span><span class="si">%22i</span><span class="s1">s_speed%5C</span><span class="si">%22%</span><span class="s1">3A1%2C%5C</span><span class="si">%22i</span><span class="s1">s_visible%5C</span><span class="si">%22%</span><span class="s1">3A0%7D%22; IsDouyinActive=true; home_can_add_dy_2_desktop=</span><span class="si">%221%</span><span class="s1">22; bd_ticket_guard_client_data=eyJiZC10aWNrZXQtZ3VhcmQtdmVyc2lvbiI6MiwiYmQtdGlja2V0LWd1YXJkLWl0ZXJhdGlvbi12ZXJzaW9uIjoxLCJiZC10aWNrZXQtZ3VhcmQtcmVlLXB1YmxpYy1rZXkiOiJCS2YzVEJvZW5vTFZ5THVzOHRBREhDaGo3elh4MmZUOW9xMW9oK2orSlU2OFEwcnRycU4xNHFQS1U1bHhmajdMNUkvLzNXRkJocktOMW1hb2VWdDk5WlE9IiwiYmQtdGlja2V0LWd1YXJkLXdlYi12ZXJzaW9uIjoxfQ%3D%3D; biz_trace_id=aec030d4&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Referer&#39;</span><span class="p">:</span> <span class="s1">&#39;https://www.douyin.com/user/MS4wLjABAAAA3q_M7SAG4eQnFrskafFBDLnycg_2s21oi7Q_aI42C2Q&#39;</span><span class="p">,</span>
        <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="s1">&#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36 Edg/120.0.0.0&#39;</span>
    <span class="p">}</span></div>

    <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://www.douyin.com/aweme/v1/web/aweme/post/?device_platform=webapp&amp;aid=6383&amp;channel=channel_pc_web&amp;sec_user_id=MS4wLjABAAAA3q_M7SAG4eQnFrskafFBDLnycg_2s21oi7Q_aI42C2Q&amp;max_cursor=0&amp;locate_query=false&amp;show_live_replay_strategy=1&amp;need_time_list=1&amp;time_list_query=0&amp;whale_cut_token=&amp;cut_version=1&amp;count=18&amp;publish_video_strategy_type=2&amp;update_version_code=170400&amp;pc_client_type=1&amp;version_code=290100&amp;version_name=29.1.0&amp;cookie_enabled=true&amp;screen_width=1536&amp;screen_height=960&amp;browser_language=zh-CN&amp;browser_platform=Win32&amp;browser_name=Edge&amp;browser_version=120.0.0.0&amp;browser_online=true&amp;engine_name=Blink&amp;engine_version=120.0.0.0&amp;os_name=Windows&amp;os_version=10&amp;cpu_core_num=16&amp;device_memory=8&amp;platform=PC&amp;downlink=10&amp;effective_type=4g&amp;round_trip_time=100&amp;webid=7380299229899687463&amp;msToken=8gdJJvLIyhS_BJtjtw7Fqu6mNVZbrR4qZwUd91GW7-zTxDLPHRc2ihWTkedEWHw8Toe1qvjz8KnzrBxK28MRww8keaOC98zmHIP3prq_ntj3oKTSSHJZObYF0oTkHHg%3D&amp;a_bogus=Yv80QmhkDDDNXd6h5UCLfY3q6lZ3Ypsn0trEMD2fmVVbsg39HMPY9exErhTva26jN4</span><span class="si">%2F</span><span class="s1">kIbfjy4hSYpqMxQIbA3v6HSRKlICh-g00t-P2so0j5ZhjCfukrUmF-vzWt-Bp-JV3EcvMoJKrFRw0AIee-wHvnwVxapt2&amp;verifyFp=verify_lztf7ywm_4zA5RL96_bnv5_4Uke_BXUL_Vtk8j1ogZmPa&amp;fp=verify_lztf7ywm_4zA5RL96_bnv5_4Uke_BXUL_Vtk8j1ogZmPa&#39;</span>

    <span class="n">res</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>

    <span class="n">aweme_list</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">json</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;aweme_list&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">aweme</span> <span class="ow">in</span> <span class="n">aweme_list</span><span class="p">:</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">aweme</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;desc&quot;</span><span class="p">)</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">aweme</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;video&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;play_addr&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;url_list&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">res</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">.mp4&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">下载成功！&quot;</span><span class="p">)</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Copyright (c) 2024 Nuanguang Gu(Sunny) Reserved.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>