{"version":3,"file":"hU1wQlN9.js","mappings":";;AAgFA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;;;AAGA;AACA;;;AAjBA;;AC5CA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAIA","sources":["webpack://knx-frontend/./homeassistant-frontend/src/components/entity/ha-entity-state-picker.ts","webpack://knx-frontend/./homeassistant-frontend/src/components/ha-selector/ha-selector-state.ts"],"sourcesContent":["import type { HassEntity } from \"home-assistant-js-websocket\";\nimport type { PropertyValues } from \"lit\";\nimport { LitElement, html, nothing } from \"lit\";\nimport { customElement, property, query, state } from \"lit/decorators\";\nimport { fireEvent } from \"../../common/dom/fire_event\";\nimport { getStates } from \"../../common/entity/get_states\";\nimport type { HomeAssistant, ValueChangedEvent } from \"../../types\";\nimport \"../ha-combo-box\";\nimport type { HaComboBox } from \"../ha-combo-box\";\n\nexport type HaEntityPickerEntityFilterFunc = (entityId: HassEntity) => boolean;\n\n@customElement(\"ha-entity-state-picker\")\nclass HaEntityStatePicker extends LitElement {\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  @property() public entityId?: string;\n\n  @property() public attribute?: string;\n\n  @property({ attribute: false }) public extraOptions?: any[];\n\n  @property({ type: Boolean }) public autofocus = false;\n\n  @property({ type: Boolean }) public disabled = false;\n\n  @property({ type: Boolean }) public required = false;\n\n  @property({ type: Boolean, attribute: \"allow-custom-value\" })\n  public allowCustomValue;\n\n  @property() public label?: string;\n\n  @property() public value?: string;\n\n  @property() public helper?: string;\n\n  @state() private _opened = false;\n\n  @query(\"ha-combo-box\", true) private _comboBox!: HaComboBox;\n\n  protected shouldUpdate(changedProps: PropertyValues) {\n    return !(!changedProps.has(\"_opened\") && this._opened);\n  }\n\n  protected updated(changedProps: PropertyValues) {\n    if (\n      (changedProps.has(\"_opened\") && this._opened) ||\n      changedProps.has(\"entityId\") ||\n      changedProps.has(\"attribute\") ||\n      changedProps.has(\"extraOptions\")\n    ) {\n      const stateObj = this.entityId\n        ? this.hass.states[this.entityId]\n        : undefined;\n      (this._comboBox as any).items = [\n        ...(this.extraOptions ?? []),\n        ...(this.entityId && stateObj\n          ? getStates(stateObj, this.attribute).map((key) => ({\n              value: key,\n              label: !this.attribute\n                ? this.hass.formatEntityState(stateObj, key)\n                : this.hass.formatEntityAttributeValue(\n                    stateObj,\n                    this.attribute,\n                    key\n                  ),\n            }))\n          : []),\n      ];\n    }\n  }\n\n  protected render() {\n    if (!this.hass) {\n      return nothing;\n    }\n\n    return html`\n      <ha-combo-box\n        .hass=${this.hass}\n        .value=${this._value}\n        .autofocus=${this.autofocus}\n        .label=${this.label ??\n        this.hass.localize(\"ui.components.entity.entity-state-picker.state\")}\n        .disabled=${this.disabled || !this.entityId}\n        .required=${this.required}\n        .helper=${this.helper}\n        .allowCustomValue=${this.allowCustomValue}\n        item-value-path=\"value\"\n        item-label-path=\"label\"\n        @opened-changed=${this._openedChanged}\n        @value-changed=${this._valueChanged}\n      >\n      </ha-combo-box>\n    `;\n  }\n\n  private get _value() {\n    return this.value || \"\";\n  }\n\n  private _openedChanged(ev: ValueChangedEvent<boolean>) {\n    this._opened = ev.detail.value;\n  }\n\n  private _valueChanged(ev: ValueChangedEvent<string>) {\n    ev.stopPropagation();\n    const newValue = ev.detail.value;\n    if (newValue !== this._value) {\n      this._setValue(newValue);\n    }\n  }\n\n  private _setValue(value: string) {\n    this.value = value;\n    setTimeout(() => {\n      fireEvent(this, \"value-changed\", { value });\n      fireEvent(this, \"change\");\n    }, 0);\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-entity-state-picker\": HaEntityStatePicker;\n  }\n}\n","import { html, LitElement } from \"lit\";\nimport { customElement, property } from \"lit/decorators\";\nimport type { StateSelector } from \"../../data/selector\";\nimport { SubscribeMixin } from \"../../mixins/subscribe-mixin\";\nimport type { HomeAssistant } from \"../../types\";\nimport \"../entity/ha-entity-state-picker\";\n\n@customElement(\"ha-selector-state\")\nexport class HaSelectorState extends SubscribeMixin(LitElement) {\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  @property({ attribute: false }) public selector!: StateSelector;\n\n  @property() public value?: any;\n\n  @property() public label?: string;\n\n  @property() public helper?: string;\n\n  @property({ type: Boolean }) public disabled = false;\n\n  @property({ type: Boolean }) public required = true;\n\n  @property({ attribute: false }) public context?: {\n    filter_attribute?: string;\n    filter_entity?: string;\n  };\n\n  protected render() {\n    return html`\n      <ha-entity-state-picker\n        .hass=${this.hass}\n        .entityId=${this.selector.state?.entity_id ||\n        this.context?.filter_entity}\n        .attribute=${this.selector.state?.attribute ||\n        this.context?.filter_attribute}\n        .extraOptions=${this.selector.state?.extra_options}\n        .value=${this.value}\n        .label=${this.label}\n        .helper=${this.helper}\n        .disabled=${this.disabled}\n        .required=${this.required}\n        allow-custom-value\n      ></ha-entity-state-picker>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-selector-state\": HaSelectorState;\n  }\n}\n"],"names":[],"sourceRoot":""}