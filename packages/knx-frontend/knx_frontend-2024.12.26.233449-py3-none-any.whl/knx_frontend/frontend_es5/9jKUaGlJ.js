"use strict";(self.webpackChunkknx_frontend=self.webpackChunkknx_frontend||[]).push([[3391],{79076:function(e,t,n){n.d(t,{Yq:function(){return u},zB:function(){return s}});var a=n(23141),i=(n(54317),n(77052),n(4187),n(68113),n(54895),n(66274),n(85767),n(45081)),r=n(99096),o=n(84656),u=((0,i.A)((function(e,t){return new Intl.DateTimeFormat(e.language,{weekday:"long",month:"long",day:"numeric",timeZone:(0,o.w)(e.time_zone,t)})})),function(e,t,n){return l(t,n.time_zone).format(e)}),l=(0,i.A)((function(e,t){return new Intl.DateTimeFormat(e.language,{year:"numeric",month:"long",day:"numeric",timeZone:(0,o.w)(e.time_zone,t)})})),s=((0,i.A)((function(e,t){return new Intl.DateTimeFormat(e.language,{year:"numeric",month:"short",day:"numeric",timeZone:(0,o.w)(e.time_zone,t)})})),function(e,t,n){var i,o,u,l,s=d(t,n.time_zone);if(t.date_format===r.ow.language||t.date_format===r.ow.system)return s.format(e);var c=s.formatToParts(e),h=null===(i=c.find((function(e){return"literal"===e.type})))||void 0===i?void 0:i.value,m=null===(o=c.find((function(e){return"day"===e.type})))||void 0===o?void 0:o.value,f=null===(u=c.find((function(e){return"month"===e.type})))||void 0===u?void 0:u.value,v=null===(l=c.find((function(e){return"year"===e.type})))||void 0===l?void 0:l.value,p=c.at(c.length-1),g="literal"===(null==p?void 0:p.type)?null==p?void 0:p.value:"";return"bg"===t.language&&t.date_format===r.ow.YMD&&(g=""),(0,a.A)((0,a.A)((0,a.A)({},r.ow.DMY,"".concat(m).concat(h).concat(f).concat(h).concat(v).concat(g)),r.ow.MDY,"".concat(f).concat(h).concat(m).concat(h).concat(v).concat(g)),r.ow.YMD,"".concat(v).concat(h).concat(f).concat(h).concat(m).concat(g))[t.date_format]}),d=(0,i.A)((function(e,t){var n=e.date_format===r.ow.system?void 0:e.language;return e.date_format===r.ow.language||(e.date_format,r.ow.system),new Intl.DateTimeFormat(n,{year:"numeric",month:"numeric",day:"numeric",timeZone:(0,o.w)(e.time_zone,t)})}));(0,i.A)((function(e,t){return new Intl.DateTimeFormat(e.language,{day:"numeric",month:"short",timeZone:(0,o.w)(e.time_zone,t)})})),(0,i.A)((function(e,t){return new Intl.DateTimeFormat(e.language,{month:"long",year:"numeric",timeZone:(0,o.w)(e.time_zone,t)})})),(0,i.A)((function(e,t){return new Intl.DateTimeFormat(e.language,{month:"long",timeZone:(0,o.w)(e.time_zone,t)})})),(0,i.A)((function(e,t){return new Intl.DateTimeFormat(e.language,{year:"numeric",timeZone:(0,o.w)(e.time_zone,t)})})),(0,i.A)((function(e,t){return new Intl.DateTimeFormat(e.language,{weekday:"long",timeZone:(0,o.w)(e.time_zone,t)})})),(0,i.A)((function(e,t){return new Intl.DateTimeFormat(e.language,{weekday:"short",timeZone:(0,o.w)(e.time_zone,t)})}))},37491:function(e,t,n){n.d(t,{r6:function(){return o}});n(77052);var a=n(45081),i=(n(79076),n(13634),n(84656)),r=n(49655),o=function(e,t,n){return u(t,n.time_zone).format(e)},u=(0,a.A)((function(e,t){return new Intl.DateTimeFormat(e.language,{year:"numeric",month:"long",day:"numeric",hour:(0,r.J)(e)?"numeric":"2-digit",minute:"2-digit",hourCycle:(0,r.J)(e)?"h12":"h23",timeZone:(0,i.w)(e.time_zone,t)})}));(0,a.A)((function(e,t){return new Intl.DateTimeFormat(e.language,{year:"numeric",month:"short",day:"numeric",hour:(0,r.J)(e)?"numeric":"2-digit",minute:"2-digit",hourCycle:(0,r.J)(e)?"h12":"h23",timeZone:(0,i.w)(e.time_zone,t)})})),(0,a.A)((function(e,t){return new Intl.DateTimeFormat(e.language,{month:"short",day:"numeric",hour:(0,r.J)(e)?"numeric":"2-digit",minute:"2-digit",hourCycle:(0,r.J)(e)?"h12":"h23",timeZone:(0,i.w)(e.time_zone,t)})})),(0,a.A)((function(e,t){return new Intl.DateTimeFormat(e.language,{year:"numeric",month:"long",day:"numeric",hour:(0,r.J)(e)?"numeric":"2-digit",minute:"2-digit",second:"2-digit",hourCycle:(0,r.J)(e)?"h12":"h23",timeZone:(0,i.w)(e.time_zone,t)})}))},13634:function(e,t,n){n.d(t,{LW:function(){return h},Xs:function(){return d},fU:function(){return o},ie:function(){return l}});var a=n(45081),i=n(84656),r=n(49655),o=function(e,t,n){return u(t,n.time_zone).format(e)},u=(0,a.A)((function(e,t){return new Intl.DateTimeFormat(e.language,{hour:"numeric",minute:"2-digit",hourCycle:(0,r.J)(e)?"h12":"h23",timeZone:(0,i.w)(e.time_zone,t)})})),l=function(e,t,n){return s(t,n.time_zone).format(e)},s=(0,a.A)((function(e,t){return new Intl.DateTimeFormat(e.language,{hour:(0,r.J)(e)?"numeric":"2-digit",minute:"2-digit",second:"2-digit",hourCycle:(0,r.J)(e)?"h12":"h23",timeZone:(0,i.w)(e.time_zone,t)})})),d=function(e,t,n){return c(t,n.time_zone).format(e)},c=(0,a.A)((function(e,t){return new Intl.DateTimeFormat(e.language,{weekday:"long",hour:(0,r.J)(e)?"numeric":"2-digit",minute:"2-digit",hourCycle:(0,r.J)(e)?"h12":"h23",timeZone:(0,i.w)(e.time_zone,t)})})),h=function(e,t,n){return m(t,n.time_zone).format(e)},m=(0,a.A)((function(e,t){return new Intl.DateTimeFormat("en-GB",{hour:"numeric",minute:"2-digit",hour12:!1,timeZone:(0,i.w)(e.time_zone,t)})}))},84656:function(e,t,n){n.d(t,{w:function(){return d}});var a,i,r,o,u,l=n(99096),s=null!==(a=null===(i=(r=Intl).DateTimeFormat)||void 0===i||null===(o=(u=i.call(r)).resolvedOptions)||void 0===o?void 0:o.call(u).timeZone)&&void 0!==a?a:"UTC",d=function(e,t){return e===l.Wj.local&&"UTC"!==s?s:t}},49655:function(e,t,n){n.d(t,{J:function(){return r}});n(53501),n(34517);var a=n(45081),i=n(99096),r=(0,a.A)((function(e){if(e.time_format===i.Hg.language||e.time_format===i.Hg.system){var t=e.time_format===i.Hg.language?e.language:void 0;return new Date("January 1, 2023 22:00:00").toLocaleString(t).includes("10")}return e.time_format===i.Hg.am_pm}))},93259:function(e,t,n){var a,i,r,o,u,l,s,d,c,h=n(23141),m=n(22481),f=n(6238),v=n(94881),p=n(66123),g=n(1781),y=n(36683),k=n(89231),b=n(29864),_=n(83647),w=n(8364),M=n(27526),A=(n(77052),n(21950),n(36724),n(848),n(43859),n(21968),n(68113),n(55888),n(56262),n(66274),n(84531),n(98168),n(34290),n(8339),n(98597)),Z=n(196),L=n(90662),z=n(33167),x=(n(91074),n(52631),{boolean:function(){return n.e(7150).then(n.bind(n,47150))},constant:function(){return n.e(3908).then(n.bind(n,73908))},float:function(){return n.e(2292).then(n.bind(n,82292))},grid:function(){return n.e(6880).then(n.bind(n,96880))},expandable:function(){return n.e(6048).then(n.bind(n,66048))},integer:function(){return n.e(3172).then(n.bind(n,73172))},multi_select:function(){return n.e(5494).then(n.bind(n,95494))},positive_time_period_dict:function(){return Promise.all([n.e(6759),n.e(2565)]).then(n.bind(n,38590))},select:function(){return n.e(3644).then(n.bind(n,73644))},string:function(){return n.e(9345).then(n.bind(n,39345))}}),E=function(e,t){return e?!t.name||t.flatten?e:e[t.name]:null};(0,w.A)([(0,Z.EM)("ha-form")],(function(e,t){var n,w=function(t){function n(){var t;(0,k.A)(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return t=(0,b.A)(this,n,[].concat(i)),e(t),t}return(0,_.A)(n,t),(0,y.A)(n)}(t);return{F:w,d:[{kind:"field",decorators:[(0,Z.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,Z.MZ)({attribute:!1})],key:"data",value:void 0},{kind:"field",decorators:[(0,Z.MZ)({attribute:!1})],key:"schema",value:void 0},{kind:"field",decorators:[(0,Z.MZ)({attribute:!1})],key:"error",value:void 0},{kind:"field",decorators:[(0,Z.MZ)({attribute:!1})],key:"warning",value:void 0},{kind:"field",decorators:[(0,Z.MZ)({type:Boolean})],key:"disabled",value:function(){return!1}},{kind:"field",decorators:[(0,Z.MZ)({attribute:!1})],key:"computeError",value:void 0},{kind:"field",decorators:[(0,Z.MZ)({attribute:!1})],key:"computeWarning",value:void 0},{kind:"field",decorators:[(0,Z.MZ)({attribute:!1})],key:"computeLabel",value:void 0},{kind:"field",decorators:[(0,Z.MZ)({attribute:!1})],key:"computeHelper",value:void 0},{kind:"field",decorators:[(0,Z.MZ)({attribute:!1})],key:"localizeValue",value:void 0},{kind:"method",key:"getFormProperties",value:function(){return{}}},{kind:"method",key:"focus",value:(n=(0,g.A)((0,v.A)().mark((function e(){var t,n,a,i;return(0,v.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.updateComplete;case 2:if(t=this.renderRoot.querySelector(".root")){e.next=5;break}return e.abrupt("return");case 5:n=(0,p.A)(t.children),e.prev=6,n.s();case 8:if((a=n.n()).done){e.next=18;break}if("HA-ALERT"===(i=a.value).tagName){e.next=16;break}if(!(i instanceof A.mN)){e.next=14;break}return e.next=14,i.updateComplete;case 14:return i.focus(),e.abrupt("break",18);case 16:e.next=8;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(6),n.e(e.t0);case 23:return e.prev=23,n.f(),e.finish(23);case 26:case"end":return e.stop()}}),e,this,[[6,20,23,26]])}))),function(){return n.apply(this,arguments)})},{kind:"method",key:"willUpdate",value:function(e){e.has("schema")&&this.schema&&this.schema.forEach((function(e){var t;"selector"in e||null===(t=x[e.type])||void 0===t||t.call(x)}))}},{kind:"method",key:"render",value:function(){var e=this;return(0,A.qy)(a||(a=(0,f.A)(['\n      <div class="root" part="root">\n        ',"\n        ","\n      </div>\n    "])),this.error&&this.error.base?(0,A.qy)(i||(i=(0,f.A)(['\n              <ha-alert alert-type="error">\n                ',"\n              </ha-alert>\n            "])),this._computeError(this.error.base,this.schema)):"",this.schema.map((function(t){var n,a=function(e,t){return e&&t.name?e[t.name]:null}(e.error,t),i=function(e,t){return e&&t.name?e[t.name]:null}(e.warning,t);return(0,A.qy)(r||(r=(0,f.A)(["\n            ","\n            ","\n          "])),a?(0,A.qy)(o||(o=(0,f.A)(['\n                  <ha-alert own-margin alert-type="error">\n                    ',"\n                  </ha-alert>\n                "])),e._computeError(a,t)):i?(0,A.qy)(u||(u=(0,f.A)(['\n                    <ha-alert own-margin alert-type="warning">\n                      ',"\n                    </ha-alert>\n                  "])),e._computeWarning(i,t)):"","selector"in t?(0,A.qy)(l||(l=(0,f.A)(["<ha-selector\n                  .schema=","\n                  .hass=","\n                  .name=","\n                  .selector=","\n                  .value=","\n                  .label=","\n                  .disabled=","\n                  .placeholder=","\n                  .helper=","\n                  .localizeValue=","\n                  .required=","\n                  .context=","\n                ></ha-selector>"])),t,e.hass,t.name,t.selector,E(e.data,t),e._computeLabel(t,e.data),t.disabled||e.disabled||!1,t.required?"":t.default,e._computeHelper(t),e.localizeValue,t.required||!1,e._generateContext(t)):(0,L._)(e.fieldElementName(t.type),Object.assign({schema:t,data:E(e.data,t),label:e._computeLabel(t,e.data),helper:e._computeHelper(t),disabled:e.disabled||t.disabled||!1,hass:e.hass,localize:null===(n=e.hass)||void 0===n?void 0:n.localize,computeLabel:e.computeLabel,computeHelper:e.computeHelper,localizeValue:e.localizeValue,context:e._generateContext(t)},e.getFormProperties())))})))}},{kind:"method",key:"fieldElementName",value:function(e){return"ha-form-".concat(e)}},{kind:"method",key:"_generateContext",value:function(e){if(e.context){for(var t={},n=0,a=Object.entries(e.context);n<a.length;n++){var i=(0,m.A)(a[n],2),r=i[0],o=i[1];t[r]=this.data[o]}return t}}},{kind:"method",key:"createRenderRoot",value:function(){var e=(0,M.A)(w,"createRenderRoot",this,3)([]);return this.addValueChangedListener(e),e}},{kind:"method",key:"addValueChangedListener",value:function(e){var t=this;e.addEventListener("value-changed",(function(e){e.stopPropagation();var n=e.target.schema;if(e.target!==t){var a=!n.name||"flatten"in n&&n.flatten?e.detail.value:(0,h.A)({},n.name,e.detail.value);t.data=Object.assign(Object.assign({},t.data),a),(0,z.r)(t,"value-changed",{value:t.data})}}))}},{kind:"method",key:"_computeLabel",value:function(e,t){return this.computeLabel?this.computeLabel(e,t):e?e.name:""}},{kind:"method",key:"_computeHelper",value:function(e){return this.computeHelper?this.computeHelper(e):""}},{kind:"method",key:"_computeError",value:function(e,t){var n=this;return Array.isArray(e)?(0,A.qy)(s||(s=(0,f.A)(["<ul>\n        ","\n      </ul>"])),e.map((function(e){return(0,A.qy)(d||(d=(0,f.A)(["<li>\n              ","\n            </li>"])),n.computeError?n.computeError(e,t):e)}))):this.computeError?this.computeError(e,t):e}},{kind:"method",key:"_computeWarning",value:function(e,t){return this.computeWarning?this.computeWarning(e,t):e}},{kind:"get",static:!0,key:"styles",value:function(){return(0,A.AH)(c||(c=(0,f.A)(["\n      .root > * {\n        display: block;\n      }\n      .root > *:not([own-margin]):not(:last-child) {\n        margin-bottom: 24px;\n      }\n      ha-alert[own-margin] {\n        margin-bottom: 4px;\n      }\n    "])))}}]}}),A.WF)},63391:function(e,t,n){n.r(t),n.d(t,{HaLocationSelector:function(){return N}});var a=n(22481),i=n(6238),r=n(95803),o=n(36683),u=n(89231),l=n(29864),s=n(83647),d=n(8364),c=(n(77052),n(848),n(43859),n(98597)),h=n(196),m=n(45081),f=n(33167),v=n(94881),p=n(1781),g=n(27526),y=(n(69466),n(21950),n(36724),n(71936),n(650),n(68113),n(84368),n(55888),n(56262),n(66274),n(85038),n(84531),n(98168),n(34290),n(8339),n(43689),n(66123)),k=(n(53156),n(66859));function b(e){return(0,k.w)(e,Date.now())}var _=n(78330);function w(e,t){return(0,_.r)((0,k.w)((null==t?void 0:t.in)||e,e),b((null==t?void 0:t.in)||e))}var M,A,Z,L,z=n(37491),x=n(13634),E=(n(27934),function(){var e=(0,p.A)((0,v.A)().mark((function e(t){var a,i,r,o;return(0,v.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.parentNode){e.next=2;break}throw new Error("Cannot setup Leaflet map on disconnected element");case 2:return e.next=4,n.e(5027).then(n.t.bind(n,75027,23));case 4:return(a=e.sent.default).Icon.Default.imagePath="/static/images/leaflet/images/",i=a.map(t),(r=document.createElement("link")).setAttribute("href","/static/images/leaflet/leaflet.css"),r.setAttribute("rel","stylesheet"),t.parentNode.appendChild(r),i.setView([52.3731339,4.8903147],13),o=F(a).addTo(i),e.abrupt("return",[i,a,o]);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),F=function(e){return e.tileLayer("https://basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}".concat(e.Browser.retina?"@2x.png":".png"),{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>, &copy; <a href="https://carto.com/attributions">CARTO</a>',subdomains:"abcd",minZoom:0,maxZoom:20})},C=n(80085),P=n(91330),I=n(14630),T=(n(96396),n(12506)),D=(0,d.A)(null,(function(e,t){var n=function(t){function n(){var t;(0,u.A)(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return t=(0,l.A)(this,n,[].concat(i)),e(t),t}return(0,s.A)(n,t),(0,o.A)(n)}(t);return{F:n,d:[{kind:"field",decorators:[(0,h.MZ)({attribute:"entity-id"})],key:"entityId",value:void 0},{kind:"field",decorators:[(0,h.MZ)({attribute:"entity-name"})],key:"entityName",value:void 0},{kind:"field",decorators:[(0,h.MZ)({attribute:"entity-picture"})],key:"entityPicture",value:void 0},{kind:"field",decorators:[(0,h.MZ)({attribute:"entity-color"})],key:"entityColor",value:void 0},{kind:"method",key:"render",value:function(){return(0,c.qy)(M||(M=(0,i.A)(['\n      <div\n        class="marker ','"\n        style=',"\n        @click=","\n      >\n        ","\n      </div>\n    "])),this.entityPicture?"picture":"",(0,T.W)({"border-color":this.entityColor}),this._badgeTap,this.entityPicture?(0,c.qy)(A||(A=(0,i.A)(['<div\n              class="entity-picture"\n              style=',"\n            ></div>"])),(0,T.W)({"background-image":"url(".concat(this.entityPicture,")")})):this.entityName)}},{kind:"method",key:"_badgeTap",value:function(e){e.stopPropagation(),this.entityId&&(0,f.r)(this,"hass-more-info",{entityId:this.entityId})}},{kind:"get",static:!0,key:"styles",value:function(){return(0,c.AH)(Z||(Z=(0,i.A)(["\n      .marker {\n        display: flex;\n        justify-content: center;\n        text-align: center;\n        align-items: center;\n        box-sizing: border-box;\n        width: 48px;\n        height: 48px;\n        font-size: var(--ha-marker-font-size, 1.5em);\n        border-radius: var(--ha-marker-border-radius, 50%);\n        border: 1px solid var(--ha-marker-color, var(--primary-color));\n        color: var(--primary-text-color);\n        background-color: var(--card-background-color);\n      }\n      .marker.picture {\n        overflow: hidden;\n      }\n      .entity-picture {\n        background-size: cover;\n        height: 100%;\n        width: 100%;\n      }\n    "])))}}]}}),c.WF);customElements.define("ha-entity-marker",D);var O,B,H,q,j,S=function(e){return"string"==typeof e?e:e.entity_id},N=((0,d.A)([(0,h.EM)("ha-map")],(function(e,t){var n,r,d=function(t){function n(){var t;(0,u.A)(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return t=(0,l.A)(this,n,[].concat(i)),e(t),t}return(0,s.A)(n,t),(0,o.A)(n)}(t);return{F:d,d:[{kind:"field",decorators:[(0,h.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,h.MZ)({attribute:!1})],key:"entities",value:void 0},{kind:"field",decorators:[(0,h.MZ)({attribute:!1})],key:"paths",value:void 0},{kind:"field",decorators:[(0,h.MZ)({attribute:!1})],key:"layers",value:void 0},{kind:"field",decorators:[(0,h.MZ)({type:Boolean})],key:"autoFit",value:function(){return!1}},{kind:"field",decorators:[(0,h.MZ)({type:Boolean})],key:"renderPassive",value:function(){return!1}},{kind:"field",decorators:[(0,h.MZ)({type:Boolean})],key:"interactiveZones",value:function(){return!1}},{kind:"field",decorators:[(0,h.MZ)({type:Boolean})],key:"fitZones",value:function(){return!1}},{kind:"field",decorators:[(0,h.MZ)({attribute:"theme-mode",type:String})],key:"themeMode",value:function(){return"auto"}},{kind:"field",decorators:[(0,h.MZ)({type:Number})],key:"zoom",value:function(){return 14}},{kind:"field",decorators:[(0,h.wk)()],key:"_loaded",value:function(){return!1}},{kind:"field",key:"leafletMap",value:void 0},{kind:"field",key:"Leaflet",value:void 0},{kind:"field",key:"_resizeObserver",value:void 0},{kind:"field",key:"_mapItems",value:function(){return[]}},{kind:"field",key:"_mapFocusItems",value:function(){return[]}},{kind:"field",key:"_mapZones",value:function(){return[]}},{kind:"field",key:"_mapFocusZones",value:function(){return[]}},{kind:"field",key:"_mapPaths",value:function(){return[]}},{kind:"method",key:"connectedCallback",value:function(){(0,g.A)(d,"connectedCallback",this,3)([]),this._loadMap(),this._attachObserver()}},{kind:"method",key:"disconnectedCallback",value:function(){(0,g.A)(d,"disconnectedCallback",this,3)([]),this.leafletMap&&(this.leafletMap.remove(),this.leafletMap=void 0,this.Leaflet=void 0),this._loaded=!1,this._resizeObserver&&this._resizeObserver.unobserve(this)}},{kind:"method",key:"update",value:function(e){var t,n;if((0,g.A)(d,"update",this,3)([e]),this._loaded){var a=!1,i=e.get("hass");if(e.has("_loaded")||e.has("entities"))this._drawEntities(),a=!0;else if(this._loaded&&i&&this.entities){var r,o=(0,y.A)(this.entities);try{for(o.s();!(r=o.n()).done;){var u=r.value;if(i.states[S(u)]!==this.hass.states[S(u)]){this._drawEntities(),a=!0;break}}}catch(l){o.e(l)}finally{o.f()}}(e.has("_loaded")||e.has("paths"))&&this._drawPaths(),(e.has("_loaded")||e.has("layers"))&&(this._drawLayers(e.get("layers")),a=!0),(e.has("_loaded")||this.autoFit&&a)&&this.fitMap(),e.has("zoom")&&this.leafletMap.setZoom(this.zoom),(e.has("themeMode")||e.has("hass")&&(!i||(null===(t=i.themes)||void 0===t?void 0:t.darkMode)!==(null===(n=this.hass.themes)||void 0===n?void 0:n.darkMode)))&&this._updateMapStyle()}}},{kind:"get",key:"_darkMode",value:function(){return"dark"===this.themeMode||"auto"===this.themeMode&&Boolean(this.hass.themes.darkMode)}},{kind:"method",key:"_updateMapStyle",value:function(){var e=this.renderRoot.querySelector("#map");e.classList.toggle("dark",this._darkMode),e.classList.toggle("forced-dark","dark"===this.themeMode),e.classList.toggle("forced-light","light"===this.themeMode)}},{kind:"field",key:"_loading",value:function(){return!1}},{kind:"method",key:"_loadMap",value:(r=(0,p.A)((0,v.A)().mark((function e(){var t,n,i;return(0,v.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._loading){e.next=2;break}return e.abrupt("return");case 2:return(t=this.shadowRoot.getElementById("map"))||((t=document.createElement("div")).id="map",this.shadowRoot.append(t)),this._loading=!0,e.prev=5,e.next=8,E(t);case 8:n=e.sent,i=(0,a.A)(n,2),this.leafletMap=i[0],this.Leaflet=i[1],this._updateMapStyle(),this._loaded=!0;case 14:return e.prev=14,this._loading=!1,e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[5,,14,17]])}))),function(){return r.apply(this,arguments)})},{kind:"method",key:"fitMap",value:function(e){var t,n,a,i;if(this.leafletMap&&this.Leaflet&&this.hass)if(this._mapFocusItems.length||this._mapFocusZones.length||null!==(t=this.layers)&&void 0!==t&&t.length){var r=this.Leaflet.latLngBounds(this._mapFocusItems?this._mapFocusItems.map((function(e){return e.getLatLng()})):[]);null===(n=this._mapFocusZones)||void 0===n||n.forEach((function(e){r.extend("getBounds"in e?e.getBounds():e.getLatLng())})),null===(a=this.layers)||void 0===a||a.forEach((function(e){r.extend("getBounds"in e?e.getBounds():e.getLatLng())})),r=r.pad(null!==(i=null==e?void 0:e.pad)&&void 0!==i?i:.5),this.leafletMap.fitBounds(r,{maxZoom:(null==e?void 0:e.zoom)||this.zoom})}else this.leafletMap.setView(new this.Leaflet.LatLng(this.hass.config.latitude,this.hass.config.longitude),(null==e?void 0:e.zoom)||this.zoom)}},{kind:"method",key:"fitBounds",value:function(e,t){var n;if(this.leafletMap&&this.Leaflet&&this.hass){var a=this.Leaflet.latLngBounds(e).pad(null!==(n=null==t?void 0:t.pad)&&void 0!==n?n:.5);this.leafletMap.fitBounds(a,{maxZoom:(null==t?void 0:t.zoom)||this.zoom})}}},{kind:"method",key:"_drawLayers",value:function(e){if(e&&e.forEach((function(e){return e.remove()})),this.layers){var t=this.leafletMap;this.layers.forEach((function(e){t.addLayer(e)}))}}},{kind:"method",key:"_computePathTooltip",value:function(e,t){var n;return n=e.fullDatetime?(0,z.r6)(t.timestamp,this.hass.locale,this.hass.config):w(t.timestamp)?(0,x.ie)(t.timestamp,this.hass.locale,this.hass.config):(0,x.Xs)(t.timestamp,this.hass.locale,this.hass.config),"".concat(e.name,"<br>").concat(n)}},{kind:"method",key:"_drawPaths",value:function(){var e=this,t=this.hass,n=this.leafletMap,a=this.Leaflet;if(t&&n&&a&&(this._mapPaths.length&&(this._mapPaths.forEach((function(e){return e.remove()})),this._mapPaths=[]),this.paths)){var i=getComputedStyle(this).getPropertyValue("--dark-primary-color");this.paths.forEach((function(t){var r,o;t.gradualOpacity&&(r=t.gradualOpacity/(t.points.length-2),o=1-t.gradualOpacity);for(var u=0;u<t.points.length-1;u++){var l=t.gradualOpacity?o+u*r:void 0;e._mapPaths.push(a.circleMarker(t.points[u].point,{radius:I.C?8:3,color:t.color||i,opacity:l,fillOpacity:l,interactive:!0}).bindTooltip(e._computePathTooltip(t,t.points[u]),{direction:"top"})),e._mapPaths.push(a.polyline([t.points[u].point,t.points[u+1].point],{color:t.color||i,opacity:l,interactive:!1}))}var s=t.points.length-1;if(s>=0){var d=t.gradualOpacity?o+s*r:void 0;e._mapPaths.push(a.circleMarker(t.points[s].point,{radius:I.C?8:3,color:t.color||i,opacity:d,fillOpacity:d,interactive:!0}).bindTooltip(e._computePathTooltip(t,t.points[s]),{direction:"top"}))}e._mapPaths.forEach((function(e){return n.addLayer(e)}))}))}}},{kind:"method",key:"_drawEntities",value:function(){var e=this.hass,t=this.leafletMap,n=this.Leaflet;if(e&&t&&n&&(this._mapItems.length&&(this._mapItems.forEach((function(e){return e.remove()})),this._mapItems=[],this._mapFocusItems=[]),this._mapZones.length&&(this._mapZones.forEach((function(e){return e.remove()})),this._mapZones=[],this._mapFocusZones=[]),this.entities)){var a,i=getComputedStyle(this),r=i.getPropertyValue("--accent-color"),o=i.getPropertyValue("--secondary-text-color"),u=i.getPropertyValue("--dark-primary-color"),l=this._darkMode?"dark":"light",s=(0,y.A)(this.entities);try{for(s.s();!(a=s.n()).done;){var d=a.value,c=e.states[S(d)];if(c){var h="string"!=typeof d?d.name:void 0,m=null!=h?h:(0,P.u)(c),f=c.attributes,v=f.latitude,p=f.longitude,g=f.passive,k=f.icon,b=f.radius,_=f.entity_picture,w=f.gps_accuracy;if(v&&p)if("zone"!==(0,C.t)(c)){var M="string"!=typeof d&&"state"===d.label_mode?this.hass.formatEntityState(c):null!=h?h:m.split(" ").map((function(e){return e[0]})).join("").substr(0,3),A=n.marker([v,p],{icon:n.divIcon({html:'\n              <ha-entity-marker\n                entity-id="'.concat(S(d),'"\n                entity-name="').concat(M,'"\n                entity-picture="').concat(_?this.hass.hassUrl(_):"",'"\n                ').concat("string"!=typeof d?'entity-color="'.concat(d.color,'"'):"","\n              ></ha-entity-marker>\n            "),iconSize:[48,48],className:""}),title:m});this._mapItems.push(A),"string"!=typeof d&&!1===d.focus||this._mapFocusItems.push(A),w&&this._mapItems.push(n.circle([v,p],{interactive:!1,color:u,radius:w}))}else{if(g&&!this.renderPassive)continue;var Z="";if(k){var L=document.createElement("ha-icon");L.setAttribute("icon",k),Z=L.outerHTML}else{var z=document.createElement("span");z.innerHTML=m,Z=z.outerHTML}this._mapZones.push(n.marker([v,p],{icon:n.divIcon({html:Z,iconSize:[24,24],className:l}),interactive:this.interactiveZones,title:m}));var x=n.circle([v,p],{interactive:!1,color:g?o:r,radius:b});this._mapZones.push(x),!this.fitZones||"string"!=typeof d&&!1===d.focus||this._mapFocusZones.push(x)}}}}catch(E){s.e(E)}finally{s.f()}this._mapItems.forEach((function(e){return t.addLayer(e)})),this._mapZones.forEach((function(e){return t.addLayer(e)}))}}},{kind:"method",key:"_attachObserver",value:(n=(0,p.A)((0,v.A)().mark((function e(){var t=this;return(0,v.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._resizeObserver||(this._resizeObserver=new ResizeObserver((function(){var e;null===(e=t.leafletMap)||void 0===e||e.invalidateSize({debounceMoveend:!0})}))),this._resizeObserver.observe(this);case 2:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{kind:"get",static:!0,key:"styles",value:function(){return(0,c.AH)(L||(L=(0,i.A)(["\n      :host {\n        display: block;\n        height: 300px;\n      }\n      #map {\n        height: 100%;\n      }\n      #map.dark {\n        background: #090909;\n      }\n      #map.forced-dark {\n        color: #ffffff;\n        --map-filter: invert(0.9) hue-rotate(170deg) brightness(1.5)\n          contrast(1.2) saturate(0.3);\n      }\n      #map.forced-light {\n        background: #ffffff;\n        color: #000000;\n        --map-filter: invert(0);\n      }\n      #map:active {\n        cursor: grabbing;\n        cursor: -moz-grabbing;\n        cursor: -webkit-grabbing;\n      }\n      .leaflet-tile-pane {\n        filter: var(--map-filter);\n      }\n      .dark .leaflet-bar a {\n        background-color: #1c1c1c;\n        color: #ffffff;\n      }\n      .dark .leaflet-bar a:hover {\n        background-color: #313131;\n      }\n      .leaflet-marker-draggable {\n        cursor: move !important;\n      }\n      .leaflet-edit-resize {\n        border-radius: 50%;\n        cursor: nesw-resize !important;\n      }\n      .named-icon {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        flex-direction: column;\n        text-align: center;\n        color: var(--primary-text-color);\n      }\n      .leaflet-pane {\n        z-index: 0 !important;\n      }\n      .leaflet-control,\n      .leaflet-top,\n      .leaflet-bottom {\n        z-index: 1 !important;\n      }\n      .leaflet-tooltip {\n        padding: 8px;\n        font-size: 90%;\n        background: rgba(80, 80, 80, 0.9) !important;\n        color: white !important;\n        border-radius: 4px;\n        box-shadow: none !important;\n        text-align: center;\n      }\n    "])))}}]}}),c.mN),(0,d.A)([(0,h.EM)("ha-locations-editor")],(function(e,t){var a,r=function(t){function a(){var t;return(0,u.A)(this,a),t=(0,l.A)(this,a),e(t),t._loadPromise=n.e(5027).then(n.t.bind(n,75027,23)).then((function(e){return n.e(9943).then(n.t.bind(n,19943,23)).then((function(){return t.Leaflet=e.default,t._updateMarkers(),t.updateComplete.then((function(){return t.fitMap()}))}))})),t}return(0,s.A)(a,t),(0,o.A)(a)}(t);return{F:r,d:[{kind:"field",decorators:[(0,h.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,h.MZ)({attribute:!1})],key:"locations",value:void 0},{kind:"field",decorators:[(0,h.MZ)()],key:"helper",value:void 0},{kind:"field",decorators:[(0,h.MZ)({type:Boolean})],key:"autoFit",value:function(){return!1}},{kind:"field",decorators:[(0,h.MZ)({type:Number})],key:"zoom",value:function(){return 16}},{kind:"field",decorators:[(0,h.MZ)({attribute:"theme-mode",type:String})],key:"themeMode",value:function(){return"auto"}},{kind:"field",decorators:[(0,h.wk)()],key:"_locationMarkers",value:void 0},{kind:"field",decorators:[(0,h.wk)()],key:"_circles",value:function(){return{}}},{kind:"field",decorators:[(0,h.P)("ha-map",!0)],key:"map",value:void 0},{kind:"field",key:"Leaflet",value:void 0},{kind:"field",key:"_loadPromise",value:void 0},{kind:"method",key:"fitMap",value:function(e){this.map.fitMap(e)}},{kind:"method",key:"fitBounds",value:function(e,t){this.map.fitBounds(e,t)}},{kind:"method",key:"fitMarker",value:(a=(0,p.A)((0,v.A)().mark((function e(t,n){var a,i;return(0,v.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.Leaflet){e.next=3;break}return e.next=3,this._loadPromise;case 3:if(this.map.leafletMap&&this._locationMarkers){e.next=5;break}return e.abrupt("return");case 5:if(a=this._locationMarkers[t]){e.next=8;break}return e.abrupt("return");case 8:"getBounds"in a?(this.map.leafletMap.fitBounds(a.getBounds()),a.bringToFront()):(i=this._circles[t])?this.map.leafletMap.fitBounds(i.getBounds()):this.map.leafletMap.setView(a.getLatLng(),(null==n?void 0:n.zoom)||this.zoom);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{kind:"method",key:"render",value:function(){return(0,c.qy)(O||(O=(0,i.A)(["\n      <ha-map\n        .hass=","\n        .layers=","\n        .zoom=","\n        .autoFit=","\n        .themeMode=","\n      ></ha-map>\n      ","\n    "])),this.hass,this._getLayers(this._circles,this._locationMarkers),this.zoom,this.autoFit,this.themeMode,this.helper?(0,c.qy)(B||(B=(0,i.A)(["<ha-input-helper-text>","</ha-input-helper-text>"])),this.helper):"")}},{kind:"field",key:"_getLayers",value:function(){return(0,m.A)((function(e,t){var n=[];return Array.prototype.push.apply(n,Object.values(e)),t&&Array.prototype.push.apply(n,Object.values(t)),n}))}},{kind:"method",key:"willUpdate",value:function(e){(0,g.A)(r,"willUpdate",this,3)([e]),this.Leaflet&&e.has("locations")&&this._updateMarkers()}},{kind:"method",key:"updated",value:function(e){var t=this;if(this.Leaflet&&e.has("locations")){var n,a,i=e.get("locations"),r=null===(n=this.locations)||void 0===n?void 0:n.filter((function(e,n){var a,r;return!i[n]||(e.latitude!==i[n].latitude||e.longitude!==i[n].longitude)&&(null===(a=t.map.leafletMap)||void 0===a?void 0:a.getBounds().contains({lat:i[n].latitude,lng:i[n].longitude}))&&!(null!==(r=t.map.leafletMap)&&void 0!==r&&r.getBounds().contains({lat:e.latitude,lng:e.longitude}))}));if(1===(null==r?void 0:r.length))null===(a=this.map.leafletMap)||void 0===a||a.panTo({lat:r[0].latitude,lng:r[0].longitude})}}},{kind:"method",key:"_updateLocation",value:function(e){var t=e.target,n=t.getLatLng(),a=n.lng;Math.abs(a)>180&&(a=(a%360+540)%360-180);var i=[n.lat,a];(0,f.r)(this,"location-updated",{id:t.id,location:i},{bubbles:!1})}},{kind:"method",key:"_updateRadius",value:function(e){var t=e.target,n=this._locationMarkers[t.id];(0,f.r)(this,"radius-updated",{id:t.id,radius:n.getRadius()},{bubbles:!1})}},{kind:"method",key:"_markerClicked",value:function(e){var t=e.target;(0,f.r)(this,"marker-clicked",{id:t.id},{bubbles:!1})}},{kind:"method",key:"_updateMarkers",value:function(){var e=this;if(!this.locations||!this.locations.length)return this._circles={},void(this._locationMarkers=void 0);var t={},n={},a=getComputedStyle(this).getPropertyValue("--accent-color");this.locations.forEach((function(i){var r;if(i.icon||i.iconPath){var o,u=document.createElement("div");u.className="named-icon",void 0!==i.name&&(u.innerText=i.name),i.icon?(o=document.createElement("ha-icon")).setAttribute("icon",i.icon):(o=document.createElement("ha-svg-icon")).setAttribute("path",i.iconPath),u.prepend(o),r=e.Leaflet.divIcon({html:u.outerHTML,iconSize:[24,24],className:"light"})}if(i.radius){var l=e.Leaflet.circle([i.latitude,i.longitude],{color:i.radius_color||a,radius:i.radius});i.radius_editable||i.location_editable?(l.editing.enable(),l.addEventListener("add",(function(){var t=l.editing._moveMarker,n=l.editing._resizeMarkers[0];r&&t.setIcon(r),n.id=t.id=i.id,t.addEventListener("dragend",(function(t){return e._updateLocation(t)})).addEventListener("click",(function(t){return e._markerClicked(t)})),i.radius_editable?n.addEventListener("dragend",(function(t){return e._updateRadius(t)})):n.remove()})),t[i.id]=l):n[i.id]=l}if(!i.radius||!i.radius_editable&&!i.location_editable){var s={title:i.name,draggable:i.location_editable};r&&(s.icon=r);var d=e.Leaflet.marker([i.latitude,i.longitude],s).addEventListener("dragend",(function(t){return e._updateLocation(t)})).addEventListener("click",(function(t){return e._markerClicked(t)}));d.id=i.id,t[i.id]=d}})),this._circles=n,this._locationMarkers=t,(0,f.r)(this,"markers-updated")}},{kind:"get",static:!0,key:"styles",value:function(){return(0,c.AH)(H||(H=(0,i.A)(["\n      ha-map {\n        display: block;\n        height: 100%;\n      }\n    "])))}}]}}),c.WF),n(93259),(0,d.A)([(0,h.EM)("ha-selector-location")],(function(e,t){var n=function(t){function n(){var t;(0,u.A)(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return t=(0,l.A)(this,n,[].concat(i)),e(t),t}return(0,s.A)(n,t),(0,o.A)(n)}(t);return{F:n,d:[{kind:"field",decorators:[(0,h.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,h.MZ)({attribute:!1})],key:"selector",value:void 0},{kind:"field",decorators:[(0,h.MZ)({type:Object})],key:"value",value:void 0},{kind:"field",decorators:[(0,h.MZ)()],key:"label",value:void 0},{kind:"field",decorators:[(0,h.MZ)()],key:"helper",value:void 0},{kind:"field",decorators:[(0,h.MZ)({type:Boolean,reflect:!0})],key:"disabled",value:function(){return!1}},{kind:"field",key:"_schema",value:function(){return(0,m.A)((function(e,t){return[{name:"",type:"grid",schema:[{name:"latitude",required:!0,selector:{number:{step:"any"}}},{name:"longitude",required:!0,selector:{number:{step:"any"}}}]}].concat((0,r.A)(e?[{name:"radius",required:!0,default:1e3,disabled:!!t,selector:{number:{min:0,step:1,mode:"box"}}}]:[]))}))}},{kind:"method",key:"willUpdate",value:function(){var e;this.value||(this.value={latitude:this.hass.config.latitude,longitude:this.hass.config.longitude,radius:null!==(e=this.selector.location)&&void 0!==e&&e.radius?1e3:void 0})}},{kind:"method",key:"render",value:function(){var e,t;return(0,c.qy)(q||(q=(0,i.A)(["\n      <p>",'</p>\n      <ha-locations-editor\n        class="flex"\n        .hass=',"\n        .helper=","\n        .locations=","\n        @location-updated=","\n        @radius-updated=","\n      ></ha-locations-editor>\n      <ha-form\n        .hass=","\n        .schema=","\n        .data=","\n        .computeLabel=","\n        .disabled=","\n        @value-changed=","\n      ></ha-form>\n    "])),this.label?this.label:"",this.hass,this.helper,this._location(this.selector,this.value),this._locationChanged,this._radiusChanged,this.hass,this._schema(null===(e=this.selector.location)||void 0===e?void 0:e.radius,null===(t=this.selector.location)||void 0===t?void 0:t.radius_readonly),this.value,this._computeLabel,this.disabled,this._valueChanged)}},{kind:"field",key:"_location",value:function(){var e=this;return(0,m.A)((function(t,n){var a,i,r,o,u,l,s=getComputedStyle(e),d=null!==(a=t.location)&&void 0!==a&&a.radius?s.getPropertyValue("--zone-radius-color")||s.getPropertyValue("--accent-color"):void 0;return[{id:"location",latitude:!n||isNaN(n.latitude)?e.hass.config.latitude:n.latitude,longitude:!n||isNaN(n.longitude)?e.hass.config.longitude:n.longitude,radius:null!==(i=t.location)&&void 0!==i&&i.radius?(null==n?void 0:n.radius)||1e3:void 0,radius_color:d,icon:null!==(r=t.location)&&void 0!==r&&r.icon||null!==(o=t.location)&&void 0!==o&&o.radius?"mdi:map-marker-radius":"mdi:map-marker",location_editable:!0,radius_editable:!(null===(u=t.location)||void 0===u||!u.radius||null!==(l=t.location)&&void 0!==l&&l.radius_readonly)}]}))}},{kind:"method",key:"_locationChanged",value:function(e){var t=(0,a.A)(e.detail.location,2),n=t[0],i=t[1];(0,f.r)(this,"value-changed",{value:Object.assign(Object.assign({},this.value),{},{latitude:n,longitude:i})})}},{kind:"method",key:"_radiusChanged",value:function(e){var t=Math.round(e.detail.radius);(0,f.r)(this,"value-changed",{value:Object.assign(Object.assign({},this.value),{},{radius:t})})}},{kind:"method",key:"_valueChanged",value:function(e){var t,n;e.stopPropagation();var a=e.detail.value,i=Math.round(e.detail.value.radius);(0,f.r)(this,"value-changed",{value:Object.assign({latitude:a.latitude,longitude:a.longitude},null===(t=this.selector.location)||void 0===t||!t.radius||null!==(n=this.selector.location)&&void 0!==n&&n.radius_readonly?{}:{radius:i})})}},{kind:"field",key:"_computeLabel",value:function(){var e=this;return function(t){return t.name?e.hass.localize("ui.components.selectors.location.".concat(t.name)):""}}},{kind:"field",static:!0,key:"styles",value:function(){return(0,c.AH)(j||(j=(0,i.A)(["\n    ha-locations-editor {\n      display: block;\n      height: 400px;\n      margin-bottom: 16px;\n    }\n    p {\n      margin-top: 0;\n    }\n  "])))}}]}}),c.WF))},99096:function(e,t,n){n.d(t,{ow:function(){return o},zt:function(){return u},jG:function(){return a},Hg:function(){return i},Wj:function(){return r}});n(94881),n(1781),n(43859);var a=function(e){return e.language="language",e.system="system",e.comma_decimal="comma_decimal",e.decimal_comma="decimal_comma",e.space_comma="space_comma",e.none="none",e}({}),i=function(e){return e.language="language",e.system="system",e.am_pm="12",e.twenty_four="24",e}({}),r=function(e){return e.local="local",e.server="server",e}({}),o=function(e){return e.language="language",e.system="system",e.DMY="DMY",e.MDY="MDY",e.YMD="YMD",e}({}),u=function(e){return e.language="language",e.monday="monday",e.tuesday="tuesday",e.wednesday="wednesday",e.thursday="thursday",e.friday="friday",e.saturday="saturday",e.sunday="sunday",e}({})},14630:function(e,t,n){n.d(t,{C:function(){return a}});var a="ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0},66911:function(e,t,n){n.d(t,{x:function(){return r}});var a=n(67234),i=(n(4187),n(36724),n(68113),n(66274),n(85767),n(98168),n(66859));function r(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=i.w.bind(null,e||n.find((function(e){return"object"===(0,a.A)(e)})));return n.map(o)}},6619:function(e,t,n){n.d(t,{Cg:function(){return r},_P:function(){return u},my:function(){return a},s0:function(){return o},w4:function(){return i}});Math.pow(10,8);var a=6048e5,i=864e5,r=6e4,o=36e5,u=Symbol.for("constructDateFrom")},66859:function(e,t,n){n.d(t,{w:function(){return r}});var a=n(67234),i=n(6619);function r(e,t){return"function"==typeof e?e(t):e&&"object"===(0,a.A)(e)&&i._P in e?e[i._P](t):e instanceof Date?new e.constructor(t):new Date(t)}},78330:function(e,t,n){n.d(t,{r:function(){return o}});var a=n(22481),i=n(66911),r=n(5801);function o(e,t,n){var o=(0,i.x)(null==n?void 0:n.in,e,t),u=(0,a.A)(o,2),l=u[0],s=u[1];return+(0,r.o)(l)==+(0,r.o)(s)}},5801:function(e,t,n){n.d(t,{o:function(){return i}});var a=n(97245);function i(e,t){var n=(0,a.a)(e,null==t?void 0:t.in);return n.setHours(0,0,0,0),n}},97245:function(e,t,n){n.d(t,{a:function(){return i}});var a=n(66859);function i(e,t){return(0,a.w)(t||e,e)}}}]);