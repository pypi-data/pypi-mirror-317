export const ids=["51439"];export const modules={50875:function(t,e,n){n.d(e,{Eu:function(){return i},hZ:function(){return o}});var a=n(11259);const s=["#4269d0","#f4bd4a","#ff725c","#6cc5b0","#a463f2","#ff8ab7","#9c6b4e","#97bbf5","#01ab63","#9498a0","#094bad","#c99000","#d84f3e","#49a28f","#048732","#d96895","#8043ce","#7599d1","#7a4c31","#74787f","#6989f4","#ffd444","#ff957c","#8fe9d3","#62cc71","#ffadda","#c884ff","#badeff","#bf8b6d","#b6bac2","#927acc","#97ee3f","#bf3947","#9f5b00","#f48758","#8caed6","#f2b94f","#eff26e","#e43872","#d9b100","#9d7a00","#698cff","#d9d9d9","#00d27e","#d06800","#009f82","#c49200","#cbe8ff","#fecddf","#c27eb6","#8cd2ce","#c4b8d9","#f883b0","#a49100","#f48800","#27d0df","#a04a9b"];function i(t){return s[t%s.length]}function o(t,e){const n=e.getPropertyValue(`--graph-color-${t+1}`)||i(t);return(0,a.Rq)(n)}},68958:function(t,e,n){n.d(e,{t:function(){return i}});n(92745),n(39527),n(41360),n(88972);class a{constructor(t=window.localStorage){this.storage=void 0,this._storage={},this._listeners={},this.storage=t,t===window.localStorage&&window.addEventListener("storage",(t=>{t.key&&this.hasKey(t.key)&&(this._storage[t.key]=t.newValue?JSON.parse(t.newValue):t.newValue,this._listeners[t.key]&&this._listeners[t.key].forEach((e=>e(t.oldValue?JSON.parse(t.oldValue):t.oldValue,this._storage[t.key]))))}))}addFromStorage(t){if(!this._storage[t]){const e=this.storage.getItem(t);e&&(this._storage[t]=JSON.parse(e))}}subscribeChanges(t,e){return this._listeners[t]?this._listeners[t].push(e):this._listeners[t]=[e],()=>{this.unsubscribeChanges(t,e)}}unsubscribeChanges(t,e){if(!(t in this._listeners))return;const n=this._listeners[t].indexOf(e);-1!==n&&this._listeners[t].splice(n,1)}hasKey(t){return t in this._storage}getValue(t){return this._storage[t]}setValue(t,e){const n=this._storage[t];this._storage[t]=e;try{void 0===e?this.storage.removeItem(t):this.storage.setItem(t,JSON.stringify(e))}catch(t){}finally{this._listeners[t]&&this._listeners[t].forEach((t=>t(n,e)))}}}const s={},i=t=>e=>{const n=t.storage||"localStorage";let i;n&&n in s?i=s[n]:(i=new a(window[n]),s[n]=i);const o=String(e.key),r=t.key||String(e.key),c=e.initializer?e.initializer():void 0;i.addFromStorage(r);const d=!1!==t.subscribe?t=>i.subscribeChanges(r,((n,a)=>{t.requestUpdate(e.key,n)})):void 0,u=()=>i.hasKey(r)?t.deserializer?t.deserializer(i.getValue(r)):i.getValue(r):c;return{kind:"method",placement:"prototype",key:e.key,descriptor:{set(n){((n,a)=>{let s;t.state&&(s=u()),i.setValue(r,t.serializer?t.serializer(a):a),t.state&&n.requestUpdate(e.key,s)})(this,n)},get:()=>u(),enumerable:!0,configurable:!0},finisher(n){if(t.state&&t.subscribe){const t=n.prototype.connectedCallback,e=n.prototype.disconnectedCallback;n.prototype.connectedCallback=function(){t.call(this),this[`__unbsubLocalStorage${o}`]=d?.(this)},n.prototype.disconnectedCallback=function(){e.call(this),this[`__unbsubLocalStorage${o}`]?.(),this[`__unbsubLocalStorage${o}`]=void 0}}t.state&&n.createProperty(e.key,{noAccessor:!0,...t.stateOptions})}}}},18520:function(t,e,n){n.d(e,{n:function(){return a}});const a=t=>!(t.native instanceof MouseEvent)||t.native instanceof PointerEvent&&"mouse"!==t.native.pointerType},20548:function(t,e,n){n.d(e,{H:function(){return i}});var a=n(11259),s=n(4643);function i(t,e,n,i,o,r){const c=t.getPropertyValue(o+"-"+r).trim(),d=c.length>0?c:t.getPropertyValue(o).trim();let u=(0,a.Rq)(d);return 0===c.length&&r&&(u=(0,a.CO)((0,a.p3)(e?(0,s.C)((0,a.Rw)((0,a.wK)(u)),r):(0,s.W)((0,a.Rw)((0,a.wK)(u)),r)))),i?u+=n?"32":"7F":n&&(u+="7F"),u}},53259:function(t,e,n){n.a(t,(async function(t,a){try{n.d(e,{J:function(){return f}});var s=n(21893),i=n(13809),o=n(13633),r=n(38836),c=n(50602),d=n(46467),u=n(33570),h=t([d,u,c]);function l(t,e){let n=new Date(e);return t>2&&0===n.getHours()&&(n=(0,s.b)(n,1)),n.setMinutes(0,0,0),t>35&&n.setDate(1),t>2&&n.setHours(0),n.getTime()}function f(t,e,n,a,s,h,f){const p=(0,i.j)(e,t),_=void 0!==h&&void 0!==f;if(_&&p<=35){const n=(0,o.A)(e,t),a=(0,o.A)(f,h);a>n?e=(0,r.T)(e,a-n):n>a&&(f=(0,r.T)(f,n-a))}const g={parsing:!1,interaction:{mode:"x"},scales:{x:{type:"time",suggestedMin:t.getTime(),max:l(p,e),adapters:{date:{locale:n,config:a}},ticks:{maxRotation:0,sampleSize:5,autoSkipPadding:20,font:t=>t.tick&&t.tick.major?{weight:"bold"}:{}},time:{tooltipFormat:p>35?"monthyear":p>7?"date":p>2?"weekday":p>0?"datetime":"hour",minUnit:p>35?"month":p>2?"day":"hour"}},y:{stacked:!0,type:"linear",title:{display:!0,text:s},ticks:{beginAtZero:!0,callback:t=>(0,c.uf)(Math.abs(t),n)}}},plugins:{tooltip:{position:"nearest",filter:t=>"0"!==t.formattedValue,itemSort:function(t,e){return e.datasetIndex-t.datasetIndex},callbacks:{title:t=>{if(p>0)return t[0].label;const e=new Date(t[0].parsed.x);return`${_?`${(0,d.ud)(e,n,a)}: `:""}${(0,u.mr)(e,n,a)} â€“ ${(0,u.mr)((0,r.T)(e,1),n,a)}`},label:t=>`${t.dataset.label}: ${(0,c.uf)(t.parsed.y,n)} ${s}`}},filler:{propagate:!1},legend:{display:!1,labels:{usePointStyle:!0}}},elements:{bar:{borderWidth:1.5,borderRadius:4},point:{hitRadius:50}},locale:(0,c.Hd)(n)};return _&&(g.scales.xAxisCompare={...g.scales.x,suggestedMin:h.getTime(),max:l(p,f),display:!1}),g}[d,u,c]=h.then?(await h)():h,a()}catch(p){a(p)}}))},36681:function(t,e,n){n.a(t,(async function(t,a){try{n.r(e),n.d(e,{HuiEnergyDevicesDetailGraphCard:function(){return S}});var s=n(44249),i=(n(92745),n(39527),n(99790),n(41360),n(13334),n(42625)),o=n(83389),r=n(57243),c=n(15093),d=n(35359),u=n(27486),h=n(50875),l=n(20548),f=(n(54977),n(29937),n(1118)),p=n(17705),_=n(6736),g=n(93331),m=n(53259),k=n(36522),v=n(68958),y=n(18520),b=t([m,f]);[m,f]=b.then?(await b)():b;const x="kWh";let S=(0,s.Z)([(0,c.Mo)("hui-energy-devices-detail-graph-card")],(function(t,e){return{F:class extends e{constructor(...e){super(...e),t(this)}},d:[{kind:"field",decorators:[(0,c.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,c.SB)()],key:"_config",value:void 0},{kind:"field",decorators:[(0,c.SB)()],key:"_chartData",value:()=>({datasets:[]})},{kind:"field",decorators:[(0,c.SB)()],key:"_chartDatasetExtra",value:()=>[]},{kind:"field",decorators:[(0,c.SB)()],key:"_data",value:void 0},{kind:"field",decorators:[(0,c.SB)()],key:"_start",value:()=>(0,i.I)()},{kind:"field",decorators:[(0,c.SB)()],key:"_end",value:()=>(0,o.p)()},{kind:"field",decorators:[(0,c.SB)()],key:"_compareStart",value:void 0},{kind:"field",decorators:[(0,c.SB)()],key:"_compareEnd",value:void 0},{kind:"field",decorators:[(0,v.t)({key:"energy-devices-hidden-stats",state:!0,subscribe:!1})],key:"_hiddenStats",value:()=>[]},{kind:"field",key:"_untrackedIndex",value:void 0},{kind:"field",key:"hassSubscribeRequiredHostProps",value:()=>["_config"]},{kind:"method",key:"hassSubscribe",value:function(){return[(0,f.UB)(this.hass,{key:this._config?.collection_key}).subscribe((t=>{this._data=t,this._processStatistics()}))]}},{kind:"method",key:"getCardSize",value:function(){return 3}},{kind:"method",key:"setConfig",value:function(t){this._config=t}},{kind:"method",key:"shouldUpdate",value:function(t){return(0,g.SN)(this,t)||t.size>1||!t.has("hass")}},{kind:"method",key:"willUpdate",value:function(t){(t.has("_hiddenStats")||t.has("_config"))&&this._data&&this._processStatistics()}},{kind:"method",key:"render",value:function(){return this.hass&&this._config?r.dy` <ha-card> ${this._config.title?r.dy`<h1 class="card-header">${this._config.title}</h1>`:""} <div class="content ${(0,d.$)({"has-header":!!this._config.title})}"> <ha-chart-base external-hidden .hass="${this.hass}" .data="${this._chartData}" .extraData="${this._chartDatasetExtra}" .options="${this._createOptions(this._start,this._end,this.hass.locale,this.hass.config,x,this._compareStart,this._compareEnd)}" chart-type="bar" @dataset-hidden="${this._datasetHidden}" @dataset-unhidden="${this._datasetUnhidden}"></ha-chart-base> </div> </ha-card> `:r.Ld}},{kind:"method",key:"_datasetHidden",value:function(t){const e=t.detail.index===this._untrackedIndex?"untracked":this._data.prefs.device_consumption[t.detail.index].stat_consumption;this._hiddenStats=[...this._hiddenStats,e]}},{kind:"method",key:"_datasetUnhidden",value:function(t){const e=t.detail.index===this._untrackedIndex?"untracked":this._data.prefs.device_consumption[t.detail.index].stat_consumption;this._hiddenStats=this._hiddenStats.filter((t=>t!==e))}},{kind:"field",key:"_createOptions",value(){return(0,u.Z)(((t,e,n,a,s,i,o)=>{const r=(0,m.J)(t,e,n,a,s,i,o);return{...r,interaction:{mode:"nearest"},plugins:{...r.plugins,legend:{display:!0,labels:{usePointStyle:!0}}},onClick:(t,e,n)=>{if((0,y.n)(t))return;const a=e[0]?.datasetIndex??-1;if(a<0)return;const s=this._data?.prefs.device_consumption[a]?.stat_consumption;s&&!(0,p.Hs)(s)&&((0,k.B)(this,"hass-more-info",{entityId:s}),n?.canvas?.dispatchEvent(new Event("mouseout")))}}}))}},{kind:"method",key:"_processStatistics",value:function(){const t=this._data,e=t.stats,n=t.statsCompare,a=getComputedStyle(this),s={};t.prefs.device_consumption.forEach((t=>{const n=t.stat_consumption in e&&(0,p.Kj)(e[t.stat_consumption])||0;s[t.stat_consumption]=n}));const i=t.prefs.device_consumption.map((t=>t.stat_consumption));i.sort(((t,e)=>s[e]-s[t]));const r=[],c=[],{data:d,dataExtras:u}=this._processDataSet(a,e,t.statsMetadata,t.prefs.device_consumption,i);r.push(...d),c.push(...u);const{summedData:h,compareSummedData:l}=(0,f.EH)(t),_="from_grid"in h||"solar"in h||"from_battery"in h,{consumption:g,compareConsumption:m}=_?(0,f.E4)(h,l):{consumption:void 0,compareConsumption:void 0};if(_){this._untrackedIndex=r.length;const{dataset:t,datasetExtra:e}=this._processUntracked(a,d,g,!1);r.push(t),c.push(e)}if(n){r.push({order:0,data:[]}),c.push({show_legend:!1}),r.push({order:999,data:[],xAxisID:"xAxisCompare"}),c.push({show_legend:!1});const{data:e,dataExtras:s}=this._processDataSet(a,n,t.statsMetadata,t.prefs.device_consumption,i,!0);if(r.push(...e),c.push(...s),_){const{dataset:t,datasetExtra:n}=this._processUntracked(a,e,m,!0);r.push(t),c.push(n)}}this._start=t.start,this._end=t.end||(0,o.p)(),this._compareStart=t.startCompare,this._compareEnd=t.endCompare,this._chartData={datasets:r},this._chartDatasetExtra=c}},{kind:"method",key:"_processUntracked",value:function(t,e,n,a){const s={};e.forEach((t=>{t.data.forEach((t=>{s[t.x]=(s[t.x]||0)+t.y}))}));const i=[];Object.keys(n.total).forEach((t=>{i.push({x:Number(t),y:n.total[t]-(s[t]||0)})}));return{dataset:{label:this.hass.localize("ui.panel.lovelace.cards.energy.energy_devices_detail_graph.untracked_consumption"),hidden:this._hiddenStats.includes("untracked"),borderColor:(0,l.H)(t,this.hass.themes.darkMode,!1,a,"--state-unavailable-color"),backgroundColor:(0,l.H)(t,this.hass.themes.darkMode,!0,a,"--state-unavailable-color"),data:i,order:1+this._untrackedIndex,stack:"devices",pointStyle:!a&&"circle",xAxisID:a?"xAxisCompare":void 0},datasetExtra:{show_legend:!a}}}},{kind:"method",key:"_processDataSet",value:function(t,e,n,a,s,i=!1){const o=[],r=[];return a.forEach(((a,c)=>{const d=(0,h.hZ)(c,t);let u=null;const l=[];if(a.stat_consumption in e){const t=e[a.stat_consumption];let n;for(const e of t){if(null===e.change||void 0===e.change)continue;if(u===e.start)continue;const t=new Date(e.start);l.push({x:t.getTime(),y:e.change}),u=e.start,n=e.end}1===l.length&&l.push({x:n,y:0})}const f=s.indexOf(a.stat_consumption),_=!!(this._config?.max_devices&&f>=this._config.max_devices);o.push({label:a.name||(0,p.Kd)(this.hass,a.stat_consumption,n[a.stat_consumption]),hidden:this._hiddenStats.includes(a.stat_consumption)||_,borderColor:i?d+"7F":d,backgroundColor:i?d+"32":d+"7F",data:l,order:1+f,stack:"devices",pointStyle:!i&&"circle",xAxisID:i?"xAxisCompare":void 0}),r.push({show_legend:!i&&!_})})),{data:o,dataExtras:r}}},{kind:"get",static:!0,key:"styles",value:function(){return r.iv`.card-header{padding-bottom:0}.content{padding:16px}.has-header{padding-top:0}`}}]}}),(0,_.f)(r.oi));a()}catch(t){a(t)}}))},32424:function(t,e,n){n.d(e,{E:function(){return i}});var a=n(53907),s=n(18112);function i(t,e,n){const i=(0,s.Q)(t,n?.in);return isNaN(e)?(0,a.L)(n?.in||t,NaN):e?(i.setDate(i.getDate()+e),i):i}},38836:function(t,e,n){n.d(e,{T:function(){return i}});var a=n(23711),s=n(76808);function i(t,e,n){return(0,a.n)(t,e*s.vh,n)}},23711:function(t,e,n){n.d(e,{n:function(){return i}});var a=n(53907),s=n(18112);function i(t,e,n){return(0,a.L)(n?.in||t,+(0,s.Q)(t)+e)}},23459:function(t,e,n){n.d(e,{z:function(){return i}});var a=n(53907),s=n(18112);function i(t,e,n){const i=(0,s.Q)(t,n?.in);if(isNaN(e))return(0,a.L)(n?.in||t,NaN);if(!e)return i;const o=i.getDate(),r=(0,a.L)(n?.in||t,i.getTime());r.setMonth(i.getMonth()+e+1,0);return o>=r.getDate()?r:(i.setFullYear(r.getFullYear(),r.getMonth(),o),i)}},2425:function(t,e,n){n.d(e,{U:function(){return s}});var a=n(18112);function s(t,e){const n=+(0,a.Q)(t)-+(0,a.Q)(e);return n<0?-1:n>0?1:n}},13633:function(t,e,n){n.d(e,{A:function(){return o}});var a=n(34151),s=n(18492),i=n(76808);function o(t,e,n){const[o,r]=(0,s.d)(n?.in,t,e),c=(+o-+r)/i.vh;return(0,a.u)(n?.roundingMethod)(c)}},14276:function(t,e,n){n.d(e,{_:function(){return s}});var a=n(18112);function s(t,e){return+(0,a.Q)(t)-+(0,a.Q)(e)}},6542:function(t,e,n){n.d(e,{d:()=>r});var a=n("18492"),s=n("2425");function i(t,e,n){const[s,i]=(0,a.d)(n?.in,t,e);return 12*(s.getFullYear()-i.getFullYear())+(s.getMonth()-i.getMonth())}var o=n("3938");function r(t,e,n){const[r,c,d]=(0,a.d)(n?.in,t,t,e),u=(0,s.U)(c,d),h=Math.abs(i(c,d));if(h<1)return 0;1===c.getMonth()&&c.getDate()>27&&c.setDate(30),c.setMonth(c.getMonth()-u*h);let l=(0,s.U)(c,d)===-u;(0,o.h)(r)&&1===h&&1===(0,s.U)(r,d)&&(l=!1);const f=u*(h-+l);return 0===f?0:f}},96500:function(t,e,n){n.d(e,{i:function(){return s}});var a=n(18112);function s(t,e){const n=(0,a.Q)(t,e?.in);return n.setHours(23,59,59,999),n}},2621:function(t,e,n){n.d(e,{V:function(){return s}});var a=n(18112);function s(t,e){const n=(0,a.Q)(t,e?.in),s=n.getMonth();return n.setFullYear(n.getFullYear(),s+1,0),n.setHours(23,59,59,999),n}},83389:function(t,e,n){n.d(e,{p:function(){return s}});var a=n(96500);function s(t){return(0,a.i)(Date.now(),t)}},86319:function(t,e,n){n.d(e,{b:function(){return s}});var a=n(18112);function s(t,e){return 1===(0,a.Q)(t,e?.in).getDate()}},3938:function(t,e,n){n.d(e,{h:function(){return o}});var a=n(96500),s=n(2621),i=n(18112);function o(t,e){const n=(0,i.Q)(t,e?.in);return+(0,a.i)(n,e)==+(0,s.V)(n,e)}},42625:function(t,e,n){n.d(e,{I:function(){return s}});var a=n(7591);function s(t){return(0,a.b)(Date.now(),t)}},21893:function(t,e,n){n.d(e,{b:function(){return s}});var a=n(38836);function s(t,e,n){return(0,a.T)(t,-e,n)}}};
//# sourceMappingURL=51439.d501415228d7067b.js.map