{"ast":null,"code":"import _defineProperty from\"/home/runner/work/inference/inference/xinference/web/ui/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"/home/runner/work/inference/inference/xinference/web/ui/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _toConsumableArray from\"/home/runner/work/inference/inference/xinference/web/ui/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/home/runner/work/inference/inference/xinference/web/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import AddIcon from'@mui/icons-material/Add';import DeleteIcon from'@mui/icons-material/Delete';import{Box,Button,FormControlLabel,Radio,RadioGroup,TextField,Tooltip}from'@mui/material';import React,{useEffect,useState}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var AddControlnet=function AddControlnet(_ref){var controlnetDataArr=_ref.controlnetDataArr,onGetControlnetArr=_ref.onGetControlnetArr,scrollRef=_ref.scrollRef;var _useState=useState(0),_useState2=_slicedToArray(_useState,2),count=_useState2[0],setCount=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),controlnetArr=_useState4[0],setControlnetArr=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isAdd=_useState6[0],setIsAdd=_useState6[1];useEffect(function(){if(controlnetDataArr&&controlnetDataArr.length){var dataArr=controlnetDataArr.map(function(item){setCount(count+1);item.id=count;return item;});setControlnetArr(dataArr);}},[]);useEffect(function(){var arr=controlnetArr.map(function(item){var name=item.model_name,uri=item.model_uri,model_family=item.model_family;return{model_name:name,model_uri:uri,model_family:model_family};});onGetControlnetArr(arr);isAdd&&handleScrollBottom();setIsAdd(false);},[controlnetArr]);var handleAddControlnet=function handleAddControlnet(){setCount(count+1);var item={id:count,model_name:'custom-controlnet',model_uri:'/path/to/controlnet-model',model_family:'controlnet'};setControlnetArr([].concat(_toConsumableArray(controlnetArr),[item]));setIsAdd(true);};var handleUpdateSpecsArr=function handleUpdateSpecsArr(index,type,newValue){setControlnetArr(controlnetArr.map(function(item,subIndex){if(subIndex===index){return _objectSpread(_objectSpread({},item),{},_defineProperty({},type,newValue));}return item;}));};var handleDeleteControlnet=function handleDeleteControlnet(index){setControlnetArr(controlnetArr.filter(function(_,subIndex){return index!==subIndex;}));};var handleScrollBottom=function handleScrollBottom(){scrollRef.current.scrollTo({top:scrollRef.current.scrollHeight,behavior:'smooth'});};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{style:{marginBottom:'20px'},children:\"Controlnet\"}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",size:\"small\",endIcon:/*#__PURE__*/_jsx(AddIcon,{}),className:\"addBtn\",onClick:handleAddControlnet,children:\"more\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"specs_container\",children:controlnetArr.map(function(item,index){return/*#__PURE__*/_jsxs(\"div\",{className:\"item\",children:[/*#__PURE__*/_jsx(TextField,{error:item.model_name!==''?false:true,style:{minWidth:'60%',marginTop:'10px'},label:\"Model Name\",size:\"small\",value:item.model_name,onChange:function onChange(e){handleUpdateSpecsArr(index,'model_name',e.target.value);}}),/*#__PURE__*/_jsx(Box,{padding:\"15px\"}),/*#__PURE__*/_jsx(TextField,{error:item.model_uri!==''?false:true,style:{minWidth:'60%'},label:\"Model Path\",size:\"small\",value:item.model_uri,onChange:function onChange(e){handleUpdateSpecsArr(index,'model_uri',e.target.value);}}),/*#__PURE__*/_jsx(Box,{padding:\"15px\"}),/*#__PURE__*/_jsx(\"label\",{style:{paddingLeft:5},children:\"Model Format\"}),/*#__PURE__*/_jsx(RadioGroup,{value:item.model_format,onChange:function onChange(e){handleUpdateSpecsArr(index,'model_format',e.target.value);},children:/*#__PURE__*/_jsx(Box,{sx:styles.checkboxWrapper,children:/*#__PURE__*/_jsx(Box,{sx:{marginLeft:'10px'},children:/*#__PURE__*/_jsx(FormControlLabel,{value:\"controlnet\",checked:true,control:/*#__PURE__*/_jsx(Radio,{}),label:\"controlnet\"})},item)})}),/*#__PURE__*/_jsx(Tooltip,{title:\"Delete specs\",placement:\"top\",children:/*#__PURE__*/_jsx(\"div\",{className:\"deleteBtn\",onClick:function onClick(){return handleDeleteControlnet(index);},children:/*#__PURE__*/_jsx(DeleteIcon,{className:\"deleteIcon\"})})})]},item.id);})})]});};export default AddControlnet;var styles={baseFormControl:{width:'100%',margin:'normal',size:'small'},checkboxWrapper:{display:'flex',flexWrap:'wrap',alignItems:'center',width:'100%'}};","map":{"version":3,"names":["AddIcon","DeleteIcon","Box","Button","FormControlLabel","Radio","RadioGroup","TextField","Tooltip","React","useEffect","useState","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","AddControlnet","_ref","controlnetDataArr","onGetControlnetArr","scrollRef","_useState","_useState2","_slicedToArray","count","setCount","_useState3","_useState4","controlnetArr","setControlnetArr","_useState5","_useState6","isAdd","setIsAdd","length","dataArr","map","item","id","arr","name","model_name","uri","model_uri","model_family","handleScrollBottom","handleAddControlnet","concat","_toConsumableArray","handleUpdateSpecsArr","index","type","newValue","subIndex","_objectSpread","_defineProperty","handleDeleteControlnet","filter","_","current","scrollTo","top","scrollHeight","behavior","children","style","marginBottom","variant","size","endIcon","className","onClick","error","minWidth","marginTop","label","value","onChange","e","target","padding","paddingLeft","model_format","sx","styles","checkboxWrapper","marginLeft","checked","control","title","placement","baseFormControl","width","margin","display","flexWrap","alignItems"],"sources":["/home/runner/work/inference/inference/xinference/web/ui/src/scenes/register_model/components/addControlnet.js"],"sourcesContent":["import AddIcon from '@mui/icons-material/Add'\nimport DeleteIcon from '@mui/icons-material/Delete'\nimport {\n  Box,\n  Button,\n  FormControlLabel,\n  Radio,\n  RadioGroup,\n  TextField,\n  Tooltip,\n} from '@mui/material'\nimport React, { useEffect, useState } from 'react'\n\nconst AddControlnet = ({\n  controlnetDataArr,\n  onGetControlnetArr,\n  scrollRef,\n}) => {\n  const [count, setCount] = useState(0)\n  const [controlnetArr, setControlnetArr] = useState([])\n  const [isAdd, setIsAdd] = useState(false)\n\n  useEffect(() => {\n    if (controlnetDataArr && controlnetDataArr.length) {\n      const dataArr = controlnetDataArr.map((item) => {\n        setCount(count + 1)\n        item.id = count\n        return item\n      })\n      setControlnetArr(dataArr)\n    }\n  }, [])\n\n  useEffect(() => {\n    const arr = controlnetArr.map((item) => {\n      const { model_name: name, model_uri: uri, model_family } = item\n      return {\n        model_name: name,\n        model_uri: uri,\n        model_family,\n      }\n    })\n    onGetControlnetArr(arr)\n    isAdd && handleScrollBottom()\n    setIsAdd(false)\n  }, [controlnetArr])\n\n  const handleAddControlnet = () => {\n    setCount(count + 1)\n    const item = {\n      id: count,\n      model_name: 'custom-controlnet',\n      model_uri: '/path/to/controlnet-model',\n      model_family: 'controlnet',\n    }\n    setControlnetArr([...controlnetArr, item])\n    setIsAdd(true)\n  }\n\n  const handleUpdateSpecsArr = (index, type, newValue) => {\n    setControlnetArr(\n      controlnetArr.map((item, subIndex) => {\n        if (subIndex === index) {\n          return { ...item, [type]: newValue }\n        }\n        return item\n      })\n    )\n  }\n\n  const handleDeleteControlnet = (index) => {\n    setControlnetArr(controlnetArr.filter((_, subIndex) => index !== subIndex))\n  }\n\n  const handleScrollBottom = () => {\n    scrollRef.current.scrollTo({\n      top: scrollRef.current.scrollHeight,\n      behavior: 'smooth',\n    })\n  }\n\n  return (\n    <>\n      <div>\n        <label style={{ marginBottom: '20px' }}>Controlnet</label>\n        <Button\n          variant=\"contained\"\n          size=\"small\"\n          endIcon={<AddIcon />}\n          className=\"addBtn\"\n          onClick={handleAddControlnet}\n        >\n          more\n        </Button>\n      </div>\n      <div className=\"specs_container\">\n        {controlnetArr.map((item, index) => (\n          <div className=\"item\" key={item.id}>\n            <TextField\n              error={item.model_name !== '' ? false : true}\n              style={{ minWidth: '60%', marginTop: '10px' }}\n              label=\"Model Name\"\n              size=\"small\"\n              value={item.model_name}\n              onChange={(e) => {\n                handleUpdateSpecsArr(index, 'model_name', e.target.value)\n              }}\n            />\n            <Box padding=\"15px\"></Box>\n\n            <TextField\n              error={item.model_uri !== '' ? false : true}\n              style={{ minWidth: '60%' }}\n              label=\"Model Path\"\n              size=\"small\"\n              value={item.model_uri}\n              onChange={(e) => {\n                handleUpdateSpecsArr(index, 'model_uri', e.target.value)\n              }}\n            />\n            <Box padding=\"15px\"></Box>\n\n            <label\n              style={{\n                paddingLeft: 5,\n              }}\n            >\n              Model Format\n            </label>\n            <RadioGroup\n              value={item.model_format}\n              onChange={(e) => {\n                handleUpdateSpecsArr(index, 'model_format', e.target.value)\n              }}\n            >\n              <Box sx={styles.checkboxWrapper}>\n                <Box key={item} sx={{ marginLeft: '10px' }}>\n                  <FormControlLabel\n                    value=\"controlnet\"\n                    checked\n                    control={<Radio />}\n                    label=\"controlnet\"\n                  />\n                </Box>\n              </Box>\n            </RadioGroup>\n\n            <Tooltip title=\"Delete specs\" placement=\"top\">\n              <div\n                className=\"deleteBtn\"\n                onClick={() => handleDeleteControlnet(index)}\n              >\n                <DeleteIcon className=\"deleteIcon\" />\n              </div>\n            </Tooltip>\n          </div>\n        ))}\n      </div>\n    </>\n  )\n}\n\nexport default AddControlnet\n\nconst styles = {\n  baseFormControl: {\n    width: '100%',\n    margin: 'normal',\n    size: 'small',\n  },\n  checkboxWrapper: {\n    display: 'flex',\n    flexWrap: 'wrap',\n    alignItems: 'center',\n    width: '100%',\n  },\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}